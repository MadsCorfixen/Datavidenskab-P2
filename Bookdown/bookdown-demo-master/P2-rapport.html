<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>P2 - Simulering af Data</title>
  <meta name="description" content="P2 - Simulering af Data" />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="P2 - Simulering af Data" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="P2 - Simulering af Data" />
  
  
  

<meta name="author" content="Gruppe B2-19" />


<meta name="date" content="2020-05-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">P2 - Simulering af Data</h1>
<p class="author"><em>Gruppe B2-19</em></p>
<p class="date"><em>2020-05-13</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#introduktion"><span class="toc-section-number">1</span> Introduktion</a><ul>
<li><a href="#forord"><span class="toc-section-number">1.1</span> Forord</a></li>
<li><a href="#abstractsynopsis"><span class="toc-section-number">1.2</span> Abstract/Synopsis</a></li>
<li><a href="#indledning"><span class="toc-section-number">1.3</span> Indledning</a></li>
<li><a href="#anvendte-pakker"><span class="toc-section-number">1.4</span> Anvendte pakker</a></li>
</ul></li>
<li><a href="#problemanalyse"><span class="toc-section-number">2</span> Problemanalyse</a><ul>
<li><a href="#statistikkens-udvikling"><span class="toc-section-number">2.1</span> Statistikkens udvikling</a></li>
<li><a href="#statistiksk-inferens"><span class="toc-section-number">2.2</span> Statistiksk inferens</a></li>
<li><a href="#hypotesetest"><span class="toc-section-number">2.3</span> Hypotesetest</a></li>
<li><a href="#t-test"><span class="toc-section-number">2.4</span> Hypotesetest for middelværdier</a><ul>
<li><a href="#fejltyper-afsnit"><span class="toc-section-number">2.4.1</span> Fejltyper</a></li>
<li><a href="#t-test2"><span class="toc-section-number">2.4.2</span> Uparret t-test for ikke-normalfordelte stikprøver</a></li>
</ul></li>
<li><a href="#simulering"><span class="toc-section-number">2.5</span> Simulering</a><ul>
<li><a href="#pseudorandom-number-generator"><span class="toc-section-number">2.5.1</span> Pseudorandom number generator</a></li>
<li><a href="#lineær-kongruens-generator"><span class="toc-section-number">2.5.2</span> Lineær kongruens generator</a></li>
<li><a href="#box-muller-transformation"><span class="toc-section-number">2.5.3</span> Box-Muller-transformation</a></li>
<li><a href="#pop-sim"><span class="toc-section-number">2.5.4</span> Simulering i R</a></li>
<li><a href="#repetitioner"><span class="toc-section-number">2.5.5</span> Repetitioner</a></li>
</ul></li>
<li><a href="#problemformulering"><span class="toc-section-number">2.6</span> Problemformulering</a></li>
</ul></li>
<li><a href="#permutationstest"><span class="toc-section-number">3</span> Permutationstest</a><ul>
<li><a href="#permutationer"><span class="toc-section-number">3.1</span> Permutationer</a></li>
<li><a href="#test-ved-hjælp-af-permutationer"><span class="toc-section-number">3.2</span> Test ved hjælp af permutationer</a></li>
</ul></li>
<li><a href="#boot-afsnit"><span class="toc-section-number">4</span> Bootstrap</a><ul>
<li><a href="#ikke-parametrisk-bootstrap"><span class="toc-section-number">4.1</span> Ikke-parametrisk bootstrap</a></li>
<li><a href="#bootstrap-standardfejl"><span class="toc-section-number">4.2</span> Bootstrap-standardfejl</a></li>
<li><a href="#bootstrap-hypotesetest"><span class="toc-section-number">4.3</span> Bootstrap-hypotesetest</a><ul>
<li><a href="#parret-bootstrap-test"><span class="toc-section-number">4.3.1</span> Parret bootstrap-test</a></li>
</ul></li>
</ul></li>
<li><a href="#r-set.seed2-meanfunc---functionsample_popimeansample_popi-estimator-res---replicate100-n---100-stik1---rbetan-8-2-stik2---rbetan-2-8-t_obs---absstik1-stik2-t_obs_mean---meant_obs-b---1000-bootmeans---bootbootdata-t_obs-statistic-meanfunc-r-b-fori-in-1b-andel_mindre---bootmeanst0i-t_obs_mean-andel_mindre---bootmeanst0-t_obs_mean-p_stoerre---sumandel_mindre-b-p_mindre---b-sumandel_mindre-b-p_tosidet---2minp_mindre-p_stoerre-p_vaerdi_parret---meanres-p_vaerdi_parret"><span class="toc-section-number">5</span> <code>{r} # set.seed(2) #  # meanFunc &lt;- function(sample_pop,i){mean(sample_pop[i])} #Estimator #  # res &lt;- replicate(100, { #    #   n &lt;- 100 #   stik1 &lt;- rbeta(n, 8, 2) #   stik2 &lt;- rbeta(n, 2, 8) #    #   t_obs &lt;- abs(stik1-stik2) #   t_obs_mean &lt;- mean(t_obs) #  #   B &lt;- 1000 #   bootmeans &lt;- boot::boot(data = t_obs, statistic = meanFunc, R = B) #   for(i in 1:B){ #     andel_mindre &lt;- bootmeans$t0[i] &lt; t_obs_mean #   } #    #   # andel_mindre &lt;- bootmeans$t0 &lt; t_obs_mean #   p_stoerre &lt;- (sum(andel_mindre)) / B #   p_mindre &lt;- (B-(sum(andel_mindre))) / B #  #   p_tosidet &lt;- 2*min(p_mindre, p_stoerre) # }) #  # p_vaerdi_parret &lt;- mean(res) # p_vaerdi_parret #</code></a><ul>
<li><a href="#uparret-bootstrap-test"><span class="toc-section-number">5.0.1</span> Uparret bootstrap-test</a></li>
<li><a href="#bootstrap-konfidensintervaller"><span class="toc-section-number">5.1</span> Bootstrap-konfidensintervaller</a><ul>
<li><a href="#percentilmetoden"><span class="toc-section-number">5.1.1</span> Percentilmetoden</a></li>
<li><a href="#basic-metoden"><span class="toc-section-number">5.1.2</span> Basic-metoden</a></li>
<li><a href="#t-metoden"><span class="toc-section-number">5.1.3</span> T-metoden</a></li>
<li><a href="#dækningsgrader"><span class="toc-section-number">5.1.4</span> Dækningsgrader</a></li>
</ul></li>
</ul></li>
<li><a href="#diskussion"><span class="toc-section-number">6</span> Diskussion</a></li>
<li><a href="#konklusion"><span class="toc-section-number">7</span> Konklusion</a></li>
<li><a href="#perspektivering"><span class="toc-section-number">8</span> Perspektivering</a></li>
<li><a href="#bibliografi">Bibliografi</a></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">P2 - Simulering af Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="introduktion" class="section level1">
<h1><span class="header-section-number">1</span> Introduktion</h1>
<p><strong>FIXME</strong> Husk link til Github.</p>
<div id="forord" class="section level2">
<h2><span class="header-section-number">1.1</span> Forord</h2>
</div>
<div id="abstractsynopsis" class="section level2">
<h2><span class="header-section-number">1.2</span> Abstract/Synopsis</h2>
</div>
<div id="indledning" class="section level2">
<h2><span class="header-section-number">1.3</span> Indledning</h2>
</div>
<div id="anvendte-pakker" class="section level2">
<h2><span class="header-section-number">1.4</span> Anvendte pakker</h2>
<p>bookdown</p>
<p>mosaic</p>
<p>boot</p>
<p>SimDesign</p>
<p>e1071</p>
<!--chapter:end:index.Rmd-->
<p><strong>FIXME</strong> (Afsnittet skal kigges igennem, mhp. ILT! Noget af indledening til afsnittet minder om problemanalysen)</p>
</div>
</div>
<div id="problemanalyse" class="section level1">
<h1><span class="header-section-number">2</span> Problemanalyse</h1>
<div id="statistikkens-udvikling" class="section level2">
<h2><span class="header-section-number">2.1</span> Statistikkens udvikling</h2>
<p>Ordet <em>statistik</em> stammer tilbage fra det latinske <em>statisticum collegium</em> (“statsrådgiver”) og det italienske <em>statista</em> (“statsmand” eller “politiker”), <span class="citation">(Dictionary <a href="#ref-Orddef" role="doc-biblioref">2020</a>)</span>. At statistik netop stammer derfra, giver god mening, under anskueelse af betydningen af disse to ord og den tidlige anvendelse af statistik. I takt med udviklingen af suverænitetsstaterne, steg behovet for at registrere befolkningen og dennes tilhørselsforhold. Derfor anvendte statsrådgivere og statsmænd statistik til at beskrive staten, særligt demografien. Senerere blev dette udvidet til at indsamle flere informationer, og ligeledes at analysere og fortolke disse ved hjælp af statistik.</p>
<p>To statistikere, som ligger fundamentet til den statistiske arbejdsform, der bruges i dag er Karl Pearson og Ronald Fisher.
Karl Pearson var interesseret i at udvikle matematiske metoder til at studere biologisk arv og evolution. Gennem den interesse udsprang en række bidrag til statistiske analyse metoder. Pearson opfandt korrelationskoefficienten <span class="math inline">\((R^2)\)</span> som bruges til at vise, hvor godt en regressionsmodel passer noget givent data. Udover det, opfandt han også <span class="math inline">\(\chi^2\)</span>-testen, som er en metode der bruges til at teste at observerede værdier stemmer overens med de forventede værdier, <span class="citation">(Porter <a href="#ref-KarlPearsonbrit" role="doc-biblioref">2020</a>)</span>, <span class="citation">(Matematikcenter <a href="#ref-Chiianden" role="doc-biblioref">2020</a>)</span>.</p>
<p>Ronald Fisher introducerede princippet om randomisering. Det siger, at et eksperiment skal gentages på et antal kontrolgrupper, og de elementer der bruges i eksperimentet skal tilfældigt udvælges fra hele populationen. Dette gjorde data forventningsret, som mindsker variationen i et eksperiment. Udover det har Fisher introduceret analyse af varians, også kaldet ANOVA (fra engelsk analysis of variance). Denne model bruges til at analysere forskellen mellem gruppemiddelværdier i en stikprøve, <span class="citation">(Encyclopaedia Britannica <a href="#ref-RonaldFisher" role="doc-biblioref">2020</a>)</span>.</p>
<p>Yderligere har udviklingen af computeren været med til at gøre anvendelsen af komplicerede statistiske beregninger hurtigere, mere præcise og mere tilgængelige. Anvendelsesområderne for statistik har ligeledes udviklet sig, fra i begyndelsen at være noget staten anvendte til styring af økonomi og befolkningsindblik, til stort set at være repræsenteret i alle større hverv i dag. Den moderne definition af statistik kan beskrives som evnen til at drage konklusioner om generelle tilfælde, <em>populationer</em>, på baggrund af enkelte tilfælde, <em>stikprøver</em>, <span class="citation">(Agresti and Finlay <a href="#ref-ASTAbog" role="doc-biblioref">2014</a>, s. 1)</span>.</p>
</div>
<div id="statistiksk-inferens" class="section level2">
<h2><span class="header-section-number">2.2</span> Statistiksk inferens</h2>
<p>Det følgende afsnit er baseret på <span class="citation">(AAU <a href="#ref-ASTAkursus1" role="doc-biblioref">2020</a><a href="#ref-ASTAkursus1" role="doc-biblioref">a</a>)</span>, <span class="citation">(AAU <a href="#ref-ASTAkursus2" role="doc-biblioref">2020</a><a href="#ref-ASTAkursus2" role="doc-biblioref">b</a>)</span> og <span class="citation">(AAU <a href="#ref-ASTAkursus3" role="doc-biblioref">2020</a><a href="#ref-ASTAkursus3" role="doc-biblioref">c</a>)</span>.</p>
<p>I statistisk inferens differentieres der mellem to metoder, <em>estimering</em> og <em>hypotesetest</em>. Når der estimeres på baggrund af en population, bruges stikprøven til at beskrive en ukendt del af populationen. Det kan for eksempel være gennemsnitsindkomst af danskere, <span class="math inline">\(\mu\)</span>, for hvilken der findes et estimat <span class="math inline">\(\hat{\mu}\)</span>, som bruges til at beskrive <span class="math inline">\(\mu\)</span>. Dette betegnes som et punktestimat, og vil oftest suppleres med et intervalestimat. Årsagen til dette er, at punktestimater er tilfældige, og derfor ændrer sig fra stikprøve til stikprøve. Da punktestimaters sandsynlighed for at være korrekt derfor er lig <span class="math inline">\(0\)</span>, tilstræbes det at anvende et intervalestimat, hvor det kan siges at <span class="math inline">\(\mu\)</span> med <span class="math inline">\(95\%\)</span> sikkerhed ligger, fremfor et punktestimat. Dette kaldes for et konfidensinterval.</p>
<p>Den anden form for statistisk infernes er hypotesetest. I hypotesetest opstilles først en nulhypotese, <span class="math inline">\(H_0\)</span>, og en alternativ hypotese, <span class="math inline">\(H_1 = \neg H_0\)</span>. Formålet med en hypotesetest er at indsamle nok evidens imod <span class="math inline">\(H_0\)</span>, så den kan forkastes, hvilket giver ny viden omkring populationen. En nulhypotese kunne være, at danskere tjener det samme i gennemsnit som folk fra Sverige. Der vil ved hjælp af forskellige statistike metoder, ses om der er en signifikant forskel i gennemsnittet. Hvis dette er tilfældet, vil nulhypotesen forkastes og den alternative hypotese vil antages at være sand.</p>
</div>
<div id="hypotesetest" class="section level2">
<h2><span class="header-section-number">2.3</span> Hypotesetest</h2>
<p>I det følgende afsnit introduceres hypotesetests, samt hvorledes disse anvendes til at drage konklusioner for en population, ved at opstille to hypoteser.</p>
<p>En hypotesetest baserer sig på det videnskabelige princip om falsificering. Der opstilles en indledende formodning om en population, kaldet nulhypotesen <span class="math inline">\(H_0\)</span>, og en alternativ, modsat hypotese <span class="math inline">\(H_1\)</span>. Er den indledende formodning ikke korrekt, må den alternative hypotese være gældende.</p>
<p>Ved en hypotesetest undersøges, hvorvidt der er en difference mellem observerede værdier og forventede værdier, hvis <span class="math inline">\(H_0\)</span> er sand.</p>
<p>Sandsynligheden for at der er en difference er stor, eftersom der arbejdes på en stikprøve og ikke selve populationen, og derfor benyttes et mål for, hvornår differencen er <em>for</em> stor, kaldet signifikansniveauet, <span class="math inline">\(\alpha\)</span>.</p>
<p>En hypotesetest viser sandsynligheden for mulige udfald, for på den måde at undersøge, hvorvidt <span class="math inline">\(H_0\)</span> kan forkastes, <span class="citation">(Editor <a href="#ref-HvorforHYPO" role="doc-biblioref">2015</a>)</span>.</p>
<p>Et mål for, hvor usandsynlig en observeret værdi er, hvis <span class="math inline">\(H_0\)</span> er sand, kaldes for en teststørrelse.</p>
<p>For at kunne bestemme, om en difference mellem en observeret og forventet værdi er signifikant, benyttes en signifikanstest. En signifikanstest er en metode til at finde teststørrelsen og undersøge, om den er signifikant eller ej.</p>
<p>Teststørrelsen findes ofte som antallet af standardafvigelser, den observerede værdi, <span class="math inline">\(\hat \theta\)</span>, ligger fra den forventede værdi <span class="math inline">\(\theta_0\)</span>.</p>
<p>At <span class="math inline">\(\hat \theta\)</span> ligger mere end <span class="math inline">\(3\)</span> standardafvigelser fra <span class="math inline">\(\theta_0\)</span>, er højst usandsynligt, da <span class="math inline">\(\hat \theta\)</span> i så fald er en outlier i populationen. I et sådan tilfælde er <span class="math inline">\(\theta_0\)</span> højst sandsynligt ikke populationens korrekte værdi.</p>
<p>En illustration af teststørrelsens betydning ved en normalfordeling kan ses på Figur @ref(fig:figur-Hypotesetest).</p>
<div class="figure" style="text-align: center">
<img src="images/HippoHyppo.jpeg" alt="Teststørrelsens indflydelse på nulhypotesen" width="75%" />
<p class="caption">
(#fig:figur-Hypotesetest)Teststørrelsens indflydelse på nulhypotesen
</p>
</div>
<p>Derudover benyttes testtørrelsen til at udregne <em>p</em>-værdien, som er sandsynligheden for at få en teststørrelse, der er lige så eller mere ekstrem, hvis <span class="math inline">\(H_0\)</span> er sand.</p>
<p>Værdien af teststørrelsen påvirker <em>p</em>-værdien på den måde, at når teststørrelsen bliver mere ekstrem, falder <em>p</em>-værdien. Jo mindre <em>p</em>-værdien er, des mindre stoles på <span class="math inline">\(H_0\)</span>, og hvis <em>p</em>-værdien er mindre end signifikansniveauet, <span class="math inline">\(\alpha\)</span>, forkastes <span class="math inline">\(H_0\)</span>. Er <em>p</em>-værdien derimod større end <span class="math inline">\(\alpha\)</span>, er der ikke belæg for at forkaste <span class="math inline">\(H_0\)</span> - dette betyder dog ikke, at <span class="math inline">\(H_0\)</span> givetvis er sand.</p>
<p>Normalt arbejdes der med et signifikansniveau på <span class="math inline">\(5\%\)</span>, <span class="math inline">\(\alpha=0.05\)</span>. Dog er der intet fast signifikansniveau og det kunne lige såvel være <span class="math inline">\(10\%\)</span> eller <span class="math inline">\(1\%\)</span>. Betydningen heraf diskuteres kort sidst i afsnittet under fejltyper, <span class="citation">(Team <a href="#ref-ASTA-HYPO" role="doc-biblioref">2020</a>)</span>.</p>
</div>
<div id="t-test" class="section level2">
<h2><span class="header-section-number">2.4</span> Hypotesetest for middelværdier</h2>
<p><strong>FIXME</strong> (Afsnittet kunne bruge lidt mere forklarende teskt. Mindre punktform)</p>
<p>I dette afsnit gennemgås fremgangsmåden for, hvordan en hypotesetest kan bruges til at bestemme middelværdien for en population. I dette afsnit kaldes en sådan hypotesetest for en t-test. Afsnittet er skrevet på baggrund af <span class="citation">(AAU <a href="#ref-ASTAkursus4" role="doc-biblioref">2020</a><a href="#ref-ASTAkursus4" role="doc-biblioref">d</a>)</span>.</p>
<p>Først er der nogle antagelser, der skal være opfyldt, for at t-testen ikke giver misvisende resultater.</p>
<ol style="list-style-type: decimal">
<li>Stikprøven er repræsentativ for populationen.</li>
<li>Variablen er kvantitativ.</li>
<li>Stikprøveudtagning er udført med tilfældighed.</li>
<li>Populationen er normalfordelt.</li>
</ol>
<p>Herefter opstilles hypoteserne. Nulhypotesen, <span class="math inline">\(H_0: \mu = \mu_0\)</span> og den alternative hypotese <span class="math inline">\(H_1: \mu \neq \mu_0\)</span>.</p>
<p>Dernæst sættes et signifikansniveau, <span class="math inline">\(\alpha\)</span>, der vurderer med hvilken sikkerhed <span class="math inline">\(H_0\)</span> forkastes.</p>
<p>Derefter beregnes den observerede teststørrelse, <span class="math inline">\(t_{obs} = \frac{|\bar y - \mu_o|}{\text{se}}\)</span>, hvor <span class="math inline">\(\text{se} = \frac{s}{\sqrt{n}}\)</span>.</p>
<p>Til slut findes <em>p</em>-værdien, og på baggrund af denne, bliver nulhypotesen enten forkastet eller ej.</p>
<p><strong>Eksempel</strong></p>
<p>Der vil nu vises et eksempel på en t-test. Figur @ref(fig:hist10) viser en stikprøve af <code>10</code> observationer med en middelværdi på <code>0.1322028</code>, udtaget fra en standard normalfordelt population med en forventet middelværdi på <span class="math inline">\(0\)</span>.</p>
<div class="figure" style="text-align: center">
<img src="P2-rapport_files/figure-html/hist10-1.png" alt="Histogram over 10 simulerede standard normalfordelte tal." width="672" />
<p class="caption">
(#fig:hist10)Histogram over 10 simulerede standard normalfordelte tal.
</p>
</div>
<p>I kodestykket nedenfor gennemgås den beskrevede fremgangsmåde for en t-test. I dette eksempel er <span class="math inline">\(H_0: \mu = 0\)</span>, og <span class="math inline">\(H_1: \mu \neq 0\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">n &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb1-2" title="2">forventet_middelvaerdi &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># Den forventede middelværdi er lig 0</span></a>
<a class="sourceLine" id="cb1-3" title="3">xdata &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, forventet_middelvaerdi, <span class="dv">1</span>)  <span class="co"># Der udtages en tilfældig normalfordelt stikprøve</span></a>
<a class="sourceLine" id="cb1-4" title="4">middelvaerdi &lt;-<span class="st"> </span><span class="kw">mean</span>(xdata)  <span class="co"># Middelværdien af stikprøven udregnes</span></a>
<a class="sourceLine" id="cb1-5" title="5">standardafvigelse &lt;-<span class="st"> </span><span class="kw">sd</span>(xdata)  <span class="co"># Standardafvigelsen af stikprøven udregnes</span></a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7">estimeret_standardfejl &lt;-<span class="st"> </span>standardafvigelse<span class="op">/</span><span class="kw">sqrt</span>(n)  <span class="co"># Stikprøvens estimerede standardfejl udregnes</span></a>
<a class="sourceLine" id="cb1-8" title="8"></a>
<a class="sourceLine" id="cb1-9" title="9">t_obs &lt;-<span class="st"> </span>(<span class="kw">abs</span>(middelvaerdi <span class="op">-</span><span class="st"> </span>forventet_middelvaerdi))<span class="op">/</span>estimeret_standardfejl</a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co"># Den observerede teststørrelse udregnes</span></a>
<a class="sourceLine" id="cb1-11" title="11"></a>
<a class="sourceLine" id="cb1-12" title="12">alpha_halve &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pdist</span>(<span class="st">&quot;t&quot;</span>, <span class="dt">q =</span> t_obs, <span class="dt">df =</span> n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-13" title="13">p &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>alpha_halve  <span class="co"># p-værdien udregnes</span></a></code></pre></div>
<p>Eftersom <em>p</em>-værdien er <code>0.4806056</code> <span class="math inline">\(&gt; \alpha=0.05\)</span>, forkastes <span class="math inline">\(H_0\)</span> ikke. Havde det derimod været en forventet værdi på <code>-0.5</code>, ville <em>p</em>-værdien blive <code>0.0540787</code> <span class="math inline">\(&lt; \alpha=0.05\)</span>, hvilket vil medføre, at <span class="math inline">\(H_0\)</span> forkastes og det vil formodes, at <span class="math inline">\(H_0\)</span> ikke er korrekt for populationen.</p>
<div id="fejltyper-afsnit" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Fejltyper</h3>
<p>Der er risiko for to primære fejl når der foretages en hypotesetest, som illustreret på figur @ref(fig:figur-typefejl). Den første, type-I fejl, er hvor <span class="math inline">\(H_0\)</span> forkastes, men i virkeligheden er sand, og den anden, type-II fejl, er hvor <span class="math inline">\(H_0\)</span> accepteres, men i realiteten er falsk.</p>
<p>En af de primære årsager til disse typer fejl er, hvor signifikansniveauet bliver sat, da dette i nogle tilfælde har stor betydning for, hvorvidt en hypotese bliver forkastet eller ej.</p>
<p>Sandsynligheden for type-I fejl er lig med det valgte signifikansniveau. Sandsynligheden for type-II fejl er derimod ikke let at præcisere. Dog er der stor sandsynlighed for type-II fejl, hvis den virkelige sandhed er tæt på nulhypotesen. Er den virkelige sandhed derimod langt fra nulhypotesen, vil sandsynligheden for type-II fejl være tilsvarende lille. Ligeledes har stikprøvens størrelse indflydelse, eftersom meget data mindsker risikoen for type-II fejl, hvor der er større risiko ved en mindre mængde data, <span class="citation">(Frydenberg <a href="#ref-Fejltyper" role="doc-biblioref">2001</a>)</span>.</p>
<div class="figure" style="text-align: center">
<img src="images/Typefejl.png" alt="Tabel over fejltyper" width="75%" />
<p class="caption">
(#fig:figur-typefejl)Tabel over fejltyper
</p>
</div>
<p>FIXME: Skriv om ‘styrken’ (jævnfør arbejdsblad fra 26/3)</p>
<p>Det vil påvises, hvilken betydning små differencer i middelværdien samt stikprøvestørrelsen har for andelen af type-II fejl.</p>
<pre><code>##                          Stikprøvestørrelsen, n =
## Differencen i middelværdi     5    10    25    50   200  1000 10000
##                     0.001 0.957 0.944 0.956 0.948 0.942 0.948 0.957
##                     0.1   0.956 0.945 0.937 0.914 0.817 0.409 0.000
##                     1     0.736 0.440 0.065 0.000 0.000 0.000 0.000
##                     2     0.208 0.020 0.000 0.000 0.000 0.000 0.000
##                     5     0.000 0.000 0.000 0.000 0.000 0.000 0.000</code></pre>
<p>Tabellen viser, at både stikprøvestørrelsen samt differencen i middelværdien, har stor betydningfor andelen af aftype-II fejl. Er differencen i middelværdierne <span class="math inline">\(0.001\)</span> fremgår det, at stikprøvestørrelsen mellem <span class="math inline">\(5\)</span> og <span class="math inline">\(10,000\)</span> ikke giver signifikante forskelle, hvilket medfører, at stikprøvestørrelsen skal være meget større for at mindske andelen af type-II fejl. Derudover mindskes risikoen for type-II fejl som stikprøvestørrelsen øges, hvilket også er gældende hvis differencen i middelværdierne forøges.</p>
</div>
<div id="t-test2" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Uparret t-test for ikke-normalfordelte stikprøver</h3>
<p>I nogle tilfælde er det ikke muligt at overholde alle de pågældende antagelser, som beskrevet i afsnit @ref(t-test), der hører til en t-test når der udføres statistisk inferens. Når dette sker, kan det ikke altid antages, at resultaterne er retvisende. I dette afsnit vil det vises, hvad der kan ske, hvis stikprøverne ikke er normalfordelte, når der arbejdes med en uparret t-test.</p>
<p>I dette eksempel benyttes betafordelingen, se figur @ref(fig:figurpop1), og gammafordelingen, se figur @ref(fig:figurpop2), til at udføre en uparret t-test.</p>
<div class="figure" style="text-align: center">
<img src="P2-rapport_files/figure-html/figurpop1-1.png" alt="Tæthedskurve for venstreskæv betafordeling, hvor alfa = 8 og beta = 2" width="672" />
<p class="caption">
(#fig:figurpop1)Tæthedskurve for venstreskæv betafordeling, hvor alfa = 8 og beta = 2
</p>
</div>
<div class="figure" style="text-align: center">
<img src="P2-rapport_files/figure-html/figurpop2-1.png" alt="Tæthedskurve for højreskæv gammafordeling, hvor alfa = 1 og beta = 2." width="672" />
<p class="caption">
(#fig:figurpop2)Tæthedskurve for højreskæv gammafordeling, hvor alfa = 1 og beta = 2.
</p>
</div>
<p>Nulhypotesen er <span class="math inline">\(H_0: \mu_1 - \mu_2 = 0\)</span> og den alternative hypotese er <span class="math inline">\(H_1 : \mu_1 - \mu_2 \neq 0\)</span>. Denne nulhypotese undersøges ved hjælp af en uparret t-test. Der udtages en stikprøve fra hver af de viste fordelinger, som der udføres to-sidet uparret t-test på, ved hjælp af den indbyggede funktion <code>t.test</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># t.test ud fra de to stikprøver</span></a>
<a class="sourceLine" id="cb3-2" title="2">Stik1 &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">100</span>, <span class="dv">8</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-3" title="3">Stik2 &lt;-<span class="st"> </span><span class="kw">rgamma</span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-4" title="4">t1 &lt;-<span class="st"> </span><span class="kw">t.test</span>(Stik1, Stik2, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">mu =</span> <span class="dv">0</span>, <span class="dt">conf.level =</span> <span class="fl">0.95</span>)</a></code></pre></div>
<p>Udfra t-testen fås et konfidensinterval på [<code>0.234, 0.4083</code>]. Forskellen mellem populationernes middelværdier vil ligge i dette interval med <span class="math inline">\(95\%\)</span> sikkerhed, ifølge t-testen. Dækningsgraden af et konfidensinterval udarbejdet fra en uparret t-test kan undersøges ved at trække nye stikprøver fra populationerne, i alt <span class="math inline">\(10,000\)</span> gange, og hver gang oprette et nyt konfidensinterval. Den sande dækningsgrad er andelen af gangene, forskellen mellem populationernes middelværdier er indeholdt i konfidensintervallerne.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># Undersøg dækningsgraden af konfidensintervallet ved udtræk af nye stikprøver.</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">set.seed</span>(<span class="dv">31415</span>)</a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4">middel1 &lt;-<span class="st"> </span><span class="dv">8</span><span class="op">/</span>(<span class="dv">8</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-5" title="5">middel2 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-6" title="6"></a>
<a class="sourceLine" id="cb4-7" title="7">sand_dif &lt;-<span class="st"> </span><span class="kw">abs</span>(middel1 <span class="op">-</span><span class="st"> </span>middel2)</a>
<a class="sourceLine" id="cb4-8" title="8"></a>
<a class="sourceLine" id="cb4-9" title="9">res &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">10000</span>, {</a>
<a class="sourceLine" id="cb4-10" title="10">    x1 &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">20</span>, <span class="dv">8</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-11" title="11">    x2 &lt;-<span class="st"> </span><span class="kw">rgamma</span>(<span class="dv">20</span>, <span class="dv">1</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-12" title="12">    </a>
<a class="sourceLine" id="cb4-13" title="13">    t_res &lt;-<span class="st"> </span><span class="kw">t.test</span>(x1, x2, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">conf.level =</span> <span class="fl">0.95</span>)</a>
<a class="sourceLine" id="cb4-14" title="14">    </a>
<a class="sourceLine" id="cb4-15" title="15">    konfinterval &lt;-<span class="st"> </span>t_res<span class="op">$</span>conf.int</a>
<a class="sourceLine" id="cb4-16" title="16">    </a>
<a class="sourceLine" id="cb4-17" title="17">    konfinterval[1L] <span class="op">&lt;=</span><span class="st"> </span>sand_dif <span class="op">&amp;</span><span class="st"> </span>konfinterval[2L] <span class="op">&gt;=</span><span class="st"> </span>sand_dif</a>
<a class="sourceLine" id="cb4-18" title="18">})</a>
<a class="sourceLine" id="cb4-19" title="19"></a>
<a class="sourceLine" id="cb4-20" title="20">tf &lt;-<span class="st"> </span><span class="kw">table</span>(res)</a>
<a class="sourceLine" id="cb4-21" title="21">tf</a></code></pre></div>
<pre><code>## res
## FALSE  TRUE 
##   826  9174</code></pre>
<p>Det fremgår fra tabellen, at dækningsgraden af konfidensintervallerne er <code>91.74</code><span class="math inline">\(\%\)</span>. Dette stemmer ikke overens med antagelsen om, at konfidensintervallet har en dækningsgrad på <span class="math inline">\(95\%\)</span>. Det kan derfor ikke antages, at en t-test på en ikke-normalfordelt stikprøve altid giver retvisende resultater.</p>
</div>
</div>
<div id="simulering" class="section level2">
<h2><span class="header-section-number">2.5</span> Simulering</h2>
<p>I dette afsnit, vil der redegøres for lidt baggrundsviden omkring datasimulering, og hvordan tilsyneladende tilfældige tal kan genereres ved hjælp af algoritmer. Derefter vil der ses på hvordan programmeringssproget R, kan udnyttes til at udføre disse simuleringer hurtigt og simpelt.</p>
<p>Simuleringer er en generering af estimater på mulige udfald, og på den måde en efterligning af virkeligheden. Formålet er derved at generere tilfældigt estimerede værdier ud fra en model, der simulerer virkeligheden, hvilket muliggør yderligere analyser.</p>
<p>En definition på simulering er;</p>
<blockquote>
<p>A situation or event that seems real but is not real, used especially in order to help people deal with such situations or events. - Cambridge Dictonary, <span class="citation">(Dictonary <a href="#ref-CambridgeSimulation" role="doc-biblioref">2020</a>)</span>.</p>
</blockquote>
<p>Ud fra definitionen, er formålet altså ved simuleringer at efterligne virkeligheden, så de analyser der gøres på baggrund af simuleringerne, kan bruges i virkeligheden når lignende situationer opstår.
Brancher hvor simuleringer er et yderst vigtigt redskab, er i motorsporten. I Formel 1 benytter holdene sig af simulatorer, hvor de genskaber bilerne og derved kan teste nye dele inden de producerer dem i virkeligheden for at spare ressourcer, <span class="citation">(F1 <a href="#ref-MercedesF1" role="doc-biblioref">2020</a>)</span>.</p>
<div id="pseudorandom-number-generator" class="section level3">
<h3><span class="header-section-number">2.5.1</span> Pseudorandom number generator</h3>
<p>I dette afsnit introduceres pseudo-tilfældige tal, PRNG (fra engelsk <em>pseudorandom number generator</em>), og hvorledes disse kan bringes i anvendelse i forbindelse med simuleringer. I de tilhørende underafsnit beskrives først en type af PRNG kaldet lineær kongruens generator, og dernæst en metode til at omdanne uniformt fordelte talt til standard normalfordelte tal kaldet Box-Muller-transformation.</p>
<p>En computer fungerer ved, at den modtager et input, der bearbejdes af en algoritme, som derefter returnerer et output. Der findes ingen algoritmer, som er i stand til at generere faktisk tilfældige tal. Grunden til dette er, hvis der gives det samme input, til den samme algoritme, vil resultatet være det samme output som tidligere, fordi en computer fungerer på baggrund af matematik og derfor er deterministisk. Det er dog muligt ved hjælp af en beregningsmodel at skabe en illusion af ægte tilfældighed. En sådan model kaldes for en PRNG.</p>
<p>En PRNG beskrives ved nedenstående karakteristika, <span class="citation">(Oxford <a href="#ref-PRGNfunc" role="doc-biblioref">2015</a>)</span>.</p>
<ol style="list-style-type: decimal">
<li><p>Et input, eller <em>seed</em>, på baggrund af hvilket algoritmen beregner et pseudo-tilfældigt output. Herefter fortsætter algoritmen rekursivt, hvor det forrige output anvendes som nyt input.</p></li>
<li><p>cyklussen, som beskriver den talserie, PRNG’en beregner.</p></li>
<li><p>Perioden, som beskriver hvor mange repetitioner algoritmen gennemløber, før cyklussen gentages. Jo kortere perioden er, des mere gennemskuelig vil algoritmen fremstå.</p></li>
<li><p>Fordelingen af cyklussen. Som det ses på figur @ref(fig:PRNG-fordelinger), kan fordelingen af cyklussen være jævn, hvilket viser en ligelig fordeling af cyklussen. Ses der derimod et mønster eller tendens i fordelingen, vil algoritmen ikke være forventningsret, og anvendeligheden formindskes.</p></li>
</ol>
<div class="figure" style="text-align: center">
<img src="images/prngfordelingerDK.jpeg" alt="PRNG fordelinger" width="75%" />
<p class="caption">
(#fig:PRNG-fordelinger)PRNG fordelinger
</p>
</div>
<p>En af de tidligste algoritmer til PRNG, <em>middle-square method</em>, blev udvilket af John von Neumann. Svagheden ved denne metode er, at dens periode oftest er ret kort og derfor begynder cyklussen hurtigt at gentage sig, <span class="citation">(Herzog and Lord <a href="#ref-PRNGintro" role="doc-biblioref">2002</a>, s. 12-13)</span>. I takt med udviklingen af de teknologiske hjælpemidler er der opstået mere effektive algoritmer til PRNG. En af de mere kendte og hyppigt anvendte algoritmer er lineær kongruens generator, som gennemgåes i det følgnede afsnit.</p>
</div>
<div id="lineær-kongruens-generator" class="section level3">
<h3><span class="header-section-number">2.5.2</span> Lineær kongruens generator</h3>
<p>Dette afsnit beskriver, hvorledes lineær kongruens generatorer, LCG (fra engelsk <em>linear congruential generator</em>), på baggrund af en arbitrære parametre, kan generere en cyklus af tilsyneladende tilfældige tal, som er uniformt fordelt, ved valg af passende parametre. Det følgende afsnit er primært baseret på kilden <span class="citation">(Radziwill <a href="#ref-LCGinfo" role="doc-biblioref">2015</a>)</span>.</p>
<p>LCG, der er en af de mange PRNG-generatorer, danner en cyklus af tal ved iteration, og kræver kun få parametre. Helt specifikt er algoritmen givet ved</p>
<blockquote>

<div class="definition">
<span id="def:unnamed-chunk-8" class="definition"><strong>(#def:unnamed-chunk-8) </strong></span>Givet <span class="math inline">\(a, c, m \in \mathbb{Z}\)</span>, hvor <span class="math inline">\(0 &lt; m, 0 &lt; a\)</span> og <span class="math inline">\(0 \leq c \leq m\)</span>, genererer algoritmen lineær kongruens generator en talsekvens, <span class="math inline">\(X = [X_0, X_1, \ldots, X_n]\)</span>, givet ved <span class="math inline">\(X_i = (a \cdot X_{i-1} + c) \mod m.\)</span>
</div>
</blockquote>
<p>Algoritmen fungerer således:
Der startes ved et <em>seed</em> angivet med <span class="math inline">\(X_0\)</span>, som bliver multipliceret med faktoren, <span class="math inline">\(a\)</span>, og konstantleddet, <span class="math inline">\(c\)</span>, adderes. Derefter tages modulus <span class="math inline">\(m\)</span> af værdien.</p>
<p>I figuren nedenfor kan ses tre eksempler på LCG. De to første eksempler har samme parametre, men forskelligt <em>seed</em>.</p>
<div class="figure" style="text-align: center">
<img src="images/LCG_eksempel.PNG" alt=" 3 eksempler på LCG. [@lincongenvis]" width="75%" />
<p class="caption">
(#fig:unnamed-chunk-9) 3 eksempler på LCG. <span class="citation">(Cmglee <a href="#ref-lincongenvis" role="doc-biblioref">2015</a>)</span>
</p>
</div>
<p>I teorien er parametrene arbitrære, men i praksis bruges nogle værdier oftere end andre. Begrundelsen for dette er, at der findes “dårlige” værdier for parametrene, der vil returnere en åbentlyst ikke-tilfældig cyklus. Et eksempel på dette er ved parametrene: <span class="math inline">\(m = 64, a = 33\)</span> og <span class="math inline">\(c = 12\)</span>. Efter et antal iterationer vil der ses et mønster i værdierne, og det blotte øje vil kunne se, at denne cyklus i virkeligheden ikke er tilfældig. Dette eftervises i det følgende eksempel.</p>
<p><strong>Eksempel</strong></p>
<p>De følgende simuleringer er baseret på kilden <span class="citation">(Trumbo <a href="#ref-LCGsimu" role="doc-biblioref">2005</a>)</span>, som også går mere i dybden med hvordan, der undersøges om de givne parametre genererer tilsyneladende tilfældige cyklusser.</p>
<p>Først defineres en funktion for LCG-algoritmen, som tager de nødvendige parametre for algoritmen som inputs. Derudover angives også et argument, <span class="math inline">\(n\)</span>, der fortæller hvor mange iterationer algoritmen skal foretage.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">lcg &lt;-<span class="st"> </span><span class="cf">function</span>(m, a, c, seed, n) {</a>
<a class="sourceLine" id="cb6-2" title="2">    <span class="co"># M er modulus, a er faktoren, c er tilvæksten, seed er startværdien og n er</span></a>
<a class="sourceLine" id="cb6-3" title="3">    <span class="co"># antal iterationer.</span></a>
<a class="sourceLine" id="cb6-4" title="4">    </a>
<a class="sourceLine" id="cb6-5" title="5">    r &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb6-6" title="6">    r[<span class="dv">1</span>] &lt;-<span class="st"> </span>seed  <span class="co">#Angiver startpunktet.</span></a>
<a class="sourceLine" id="cb6-7" title="7">    </a>
<a class="sourceLine" id="cb6-8" title="8">    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)) {</a>
<a class="sourceLine" id="cb6-9" title="9">        r[i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span>(a <span class="op">*</span><span class="st"> </span>r[i] <span class="op">+</span><span class="st"> </span>c)<span class="op">%%</span>m</a>
<a class="sourceLine" id="cb6-10" title="10">        </a>
<a class="sourceLine" id="cb6-11" title="11">    }</a>
<a class="sourceLine" id="cb6-12" title="12">    <span class="kw">return</span>(r)</a>
<a class="sourceLine" id="cb6-13" title="13">}</a></code></pre></div>
<p>Det følgende er et eksempel på en LCG-cyklus med en periode på <span class="math inline">\(16\)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">lcg1 &lt;-<span class="st"> </span><span class="kw">lcg</span>(<span class="dv">64</span>, <span class="dv">33</span>, <span class="dv">12</span>, <span class="dv">57</span>, <span class="dv">17</span>)</a>
<a class="sourceLine" id="cb7-2" title="2">lcg1</a></code></pre></div>
<pre><code>##  [1] 57 37 17 61 41 21  1 45 25  5 49 29  9 53 33 13 57</code></pre>
<p>Forneden i figur @ref(fig:ikke-tilfaeldig-LCG) plottes denne cyklus. Det er åbenlyst at cyklussen ikke er tilfældig, da den danner et synligt mønster. Selv hvis antallet af gange, LCG køres igennem, ændres, vil mønstret ikke ændres.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">lcg1_plot &lt;-<span class="st"> </span><span class="kw">lcg</span>(<span class="dv">64</span>, <span class="dv">33</span>, <span class="dv">12</span>, <span class="dv">57</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw">plot</span>(lcg1_plot, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Indeks&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Værdier&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="P2-rapport_files/figure-html/ikke-tilfaeldig-LCG-1.png" alt="Et eksempel på en ikke-tilfældig LCG-cyklus." width="672" />
<p class="caption">
(#fig:ikke-tilfaeldig-LCG)Et eksempel på en ikke-tilfældig LCG-cyklus.
</p>
</div>
<p>Nedenfor i figur @ref(fig:uniform-LCG) vises et eksempel på, hvordan LCG-algoritmen kan bruges til at lave en uniform fordeling i intervallet [0, 1].</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">lcg2 &lt;-<span class="st"> </span><span class="kw">lcg</span>(<span class="dv">86436</span>, <span class="dv">1093</span>, <span class="dv">0</span>, <span class="dv">12</span>, <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb10-2" title="2"></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="kw">hist</span>((lcg2 <span class="op">+</span><span class="st"> </span><span class="fl">0.05</span>)<span class="op">/</span><span class="dv">86436</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Værdier&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Frekvens&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="P2-rapport_files/figure-html/uniform-LCG-1.png" alt="Et eksempel på en LCG-cyklus, der er uniformt fordelt." width="672" />
<p class="caption">
(#fig:uniform-LCG)Et eksempel på en LCG-cyklus, der er uniformt fordelt.
</p>
</div>
<p>Her kan det også nævnes, at hvis den cyklus algoritmen returnerer plottes i et 2d-punktplot, som i figur @ref(fig:plot-LCG-cyklus), vil der fremgå en tydeligere “tilfældig” fordeling, dog vil der stadig kunne ses et mønster.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">plot</span>(lcg2, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Indeks&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Værdier&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="P2-rapport_files/figure-html/plot-LCG-cyklus-1.png" alt="En 2d-graf af en 'tilfældig' LCG-cyklus." width="672" />
<p class="caption">
(#fig:plot-LCG-cyklus)En 2d-graf af en ‘tilfældig’ LCG-cyklus.
</p>
</div>
<p>Afslutningsvist vil der vises et eksempel, hvor der returneres en cyklus, der ser tilfældig ud. Denne cyklus kan ses i figur @ref(fig:tilfaeldig-LCG).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">lcg3 &lt;-<span class="st"> </span><span class="kw">lcg</span>(<span class="dv">86436</span>, <span class="dv">1093</span>, <span class="dv">18257</span>, <span class="dv">12</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb12-2" title="2"></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="kw">plot</span>(lcg3, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Indeks&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Værdier&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="P2-rapport_files/figure-html/tilfaeldig-LCG-1.png" alt="Et eksempel på en tilsyneladende tilfældig LCG-cyklus." width="672" />
<p class="caption">
(#fig:tilfaeldig-LCG)Et eksempel på en tilsyneladende tilfældig LCG-cyklus.
</p>
</div>
</div>
<div id="box-muller-transformation" class="section level3">
<h3><span class="header-section-number">2.5.3</span> Box-Muller-transformation</h3>
<p>I dette afsnit beskrives Box-Muller-transformation, hvilket er en metode til at generere standard normalfordelte tal ud fra uniformt fordelte tal. Dette gøres for at belyse, hvordan en computer kan generere tilsyneladende tilfældige tal, der er normalfordelte. Afsnittet er skrevet med inspiration fra <span class="citation">(Weisstein <a href="#ref-Box-Muller" role="doc-biblioref">2020</a><a href="#ref-Box-Muller" role="doc-biblioref">a</a>)</span>. Metoden beskrives konkret i nedenstående sætning.</p>
<blockquote>

<div class="theorem">
<p><span id="thm:unnamed-chunk-12" class="theorem"><strong>(#thm:unnamed-chunk-12) </strong></span> Box-Muller-transformation</p>
Antag, at <span class="math inline">\(U_1\)</span> og <span class="math inline">\(U_2\)</span> er uafhængige stokastiske variabler, der begge er uniformt fordelt på intervallet <span class="math inline">\([0, 1]\)</span>. Lad <span class="math display">\[Z_1 = \sqrt{-2 \mathrm{ln} U_1} \mathrm{cos}(2\pi U_2)~ \wedge~ Z_2 = \sqrt{-2 \mathrm{ln} U_1} \mathrm{sin}(2\pi U_2).\]</span> Så er <span class="math inline">\(Z_1\)</span> og <span class="math inline">\(Z_2\)</span> uafhængige stokastiske variabler, der er standard normalfordelte.
</div>
</blockquote>
<p><strong>Eksempel</strong></p>
<p>I dette afsnit oprettes to normalfordelinger ved hjælp af Box-Muller-transformationen i R.</p>
<p>Først simuleres to stokatiske variabler, <code>U1</code> og <code>U2</code>, hvor <span class="math inline">\(\mathrm{U1 \sim unif(0,1)}\)</span> og <span class="math inline">\(\mathrm{U2 \sim unif(0,1)}\)</span>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">U1 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dt">n =</span> <span class="fl">1e+05</span>, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb13-2" title="2">U2 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dt">n =</span> <span class="fl">1e+05</span>, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>)</a></code></pre></div>
<p>Disse to stokatiske variabler benyttes nu til at oprette de to påstået standard normalfordelte stokatiske variabler, <code>Z1</code> og <code>Z2</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">Z1 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(U1)) <span class="op">*</span><span class="st"> </span><span class="kw">cos</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>U2)</a>
<a class="sourceLine" id="cb14-2" title="2">Z2 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(U1)) <span class="op">*</span><span class="st"> </span><span class="kw">sin</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>U2)</a></code></pre></div>
<p><strong>Efterprøvning i R</strong></p>
<p>I det følgende afsnit efterprøves de forventede karakteristika af de to stokastiske variabler <span class="math inline">\(Z_1\)</span> og <span class="math inline">\(Z_2\)</span>, der blev oprettet ved hjælp af Box-Muller-transformationen.</p>
<p>Først undersøges deskriptivt, hvilken fordeling <code>Z1</code> og <code>Z2</code> har, ved at oprette et boksplot af de to stokastiske variabler, som ses i figur @ref(fig:boksplotz1z2).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">boxplot</span>(Z1, Z2, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="kw">c</span>(<span class="st">&quot;Z1&quot;</span>, <span class="st">&quot;Z2&quot;</span>))</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="P2-rapport_files/figure-html/boksplotz1z2-1.png" alt="Et boksplot over Z1 og Z2" width="672" />
<p class="caption">
(#fig:boksplotz1z2)Et boksplot over Z1 og Z2
</p>
</div>
<p>Det ses på boksplottet, at der er en indikation på normalfordeling med henvisning til de fire krav et boksplot af en normalfordeling opfylder. De fire krav er: <strong>FIXME</strong> (Kilde?)</p>
<ol style="list-style-type: decimal">
<li><p>Median og middelværdi er lig hinanden.</p></li>
<li><p>Øvre og nedre kvartil er lige langt fra midten.</p></li>
<li><p>Der er lige mange outliers over øvre kvartil som under nedre kvartil.</p></li>
<li><p><span class="math inline">\(0.7\%\)</span> af observationerne ligger som outliers.</p></li>
</ol>
<p>Punkterne 2 og 3 tjekkes ved at betragte boksplottet, hvor der ikke umiddelbart synes at være noget, der modbeviser en normalfordeling af <code>Z1</code> og <code>Z2</code>.</p>
<p>For at tjekke punkt 1, beregnes median (<code>median</code>) og middelværdi (<code>mean</code>) i kodestykket nedenfor.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">mean_Z1 &lt;-<span class="st"> </span><span class="kw">mean</span>(Z1)</a>
<a class="sourceLine" id="cb16-2" title="2">median_Z1 &lt;-<span class="st"> </span><span class="kw">median</span>(Z1)</a>
<a class="sourceLine" id="cb16-3" title="3"></a>
<a class="sourceLine" id="cb16-4" title="4">mean_Z2 &lt;-<span class="st"> </span><span class="kw">mean</span>(Z2)</a>
<a class="sourceLine" id="cb16-5" title="5">median_Z2 &lt;-<span class="st"> </span><span class="kw">median</span>(Z2)</a></code></pre></div>
<p>Dette giver henholdsvis en middelværdi og median for <code>Z1</code> på <span class="math inline">\(2.4574776\times 10^{-4}\)</span> og <span class="math inline">\(3.7336997\times 10^{-4}\)</span>, samt for <code>Z2</code> på <span class="math inline">\(0.003428\)</span> og <span class="math inline">\(0.0042908\)</span>. Disse resultater ligger meget tæt på hinanden, og den meget lave værdi stemmer overens med forventningen om, at <code>Z1</code> og <code>Z2</code> er standard normalfordelte.</p>
<p>For at tjekke punkt <span class="math inline">\(4\)</span>, beregnes andelen af outliers i hvert boksplot i kodestykket nedenfor.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">OutVals1 &lt;-<span class="st"> </span><span class="kw">boxplot</span>(Z1, <span class="dt">plot =</span> <span class="ot">FALSE</span>)<span class="op">$</span>out</a>
<a class="sourceLine" id="cb17-2" title="2">outliers_Z1 &lt;-<span class="st"> </span><span class="kw">length</span>(OutVals1)</a>
<a class="sourceLine" id="cb17-3" title="3"></a>
<a class="sourceLine" id="cb17-4" title="4">OutVals2 &lt;-<span class="st"> </span><span class="kw">boxplot</span>(Z2, <span class="dt">plot =</span> <span class="ot">FALSE</span>)<span class="op">$</span>out</a>
<a class="sourceLine" id="cb17-5" title="5">outliers_Z2 &lt;-<span class="st"> </span><span class="kw">length</span>(OutVals2)</a>
<a class="sourceLine" id="cb17-6" title="6"></a>
<a class="sourceLine" id="cb17-7" title="7">outliers_andel_Z1 &lt;-<span class="st"> </span>outliers_Z1<span class="op">/</span><span class="kw">length</span>(Z1)</a>
<a class="sourceLine" id="cb17-8" title="8">outliers_andel_Z2 &lt;-<span class="st"> </span>outliers_Z2<span class="op">/</span><span class="kw">length</span>(Z2)</a></code></pre></div>
<p>Dette giver en andel af outliers i <code>Z1</code> på <code>0.00718</code> og i <code>Z2</code> på <code>0.00726</code>. Dette svarer til cirka <span class="math inline">\(0,7~ \%\)</span> outliers i både <code>Z1</code> og <code>Z2</code>, hvilket stemmer overens med punkt 4.</p>
<p>Der er altså ikke noget evidens imod, at <code>Z1</code> og <code>Z2</code> skulle være normalfordelt. Tværtimod underbygger beregningen af deres middelværdi, at de er <em>standard</em> normalfordelte.</p>
<p>Hernest kigges der på histogrammerne for <code>Z1</code> og <code>Z2</code>. På figur @ref(fig:bmhist) sammenlignes histogrammerne for henholdsvis <code>Z1</code> og <code>Z2</code> med densiteten for standard normalfordeling.</p>
<p><strong>FIXME</strong> (Lav plot om til figur, figuren skal have ref. i tekseten, samt forklaring i brødtekst.) <strong>FIXME</strong> (Sammenlign med Z-fordelings densitet)</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dt">length.out =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb18-2" title="2">y &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb18-3" title="3"></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb18-5" title="5"></a>
<a class="sourceLine" id="cb18-6" title="6"><span class="kw">hist</span>(Z1, <span class="dt">main =</span> <span class="st">&quot;(a)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Frekvens&quot;</span>, <span class="dt">prob =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb18-7" title="7"><span class="kw">lines</span>(x, y, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb18-8" title="8"></a>
<a class="sourceLine" id="cb18-9" title="9"><span class="kw">hist</span>(Z2, <span class="dt">main =</span> <span class="st">&quot;(b)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Frekvens&quot;</span>, <span class="dt">prob =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb18-10" title="10"><span class="kw">lines</span>(x, y, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="P2-rapport_files/figure-html/bmhist-1.png" alt="Sammenligning af histogrammerne for henholdsvis Z1 (a) og Z2 (b) med densiteten for standard normalfordeling." width="672" />
<p class="caption">
(#fig:bmhist)Sammenligning af histogrammerne for henholdsvis Z1 (a) og Z2 (b) med densiteten for standard normalfordeling.
</p>
</div>
<p>Det ses på histogrammerne, at de tilnærmelsesvist er normalfordelte, samt at de har en middelværdi på <span class="math inline">\(\approx 0\)</span> og en standardafvigelse på <span class="math inline">\(\approx 1\)</span>, og derved er <code>Z1</code> og <code>Z2</code> standard normalfordelte.</p>
<p>Desuden er det også en konsekvens af Box-Muller-transformationerne, at <code>Z1</code> og <code>Z2</code> er uafhængige. Dette undersøges ved hjælp af nedenstående graf.</p>
<p><strong>FIXME:</strong> (Husk at indsætte figuren inden aflevering! :-))</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">plot</span>(Z2 <span class="op">~</span><span class="st"> </span>Z1, <span class="dt">main =</span> <span class="st">&quot;Graf for uafhængighed mellem Z1 og Z2&quot;</span>, <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dt">red =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb19-2" title="2">    <span class="dt">green =</span> <span class="dv">0</span>, <span class="dt">blue =</span> <span class="dv">0</span>, <span class="dt">alpha =</span> <span class="fl">0.25</span>), <span class="dt">pch =</span> <span class="dv">1</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<p><img src="P2-rapport_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Udover at eftervise uafhængigheden af <code>Z1</code> og <code>Z2</code> grafisk, kan det også undersøges ved hjælp af funktionen <code>cor</code> i R, som giver en værdi for korrelationen af de to talsekvenser.
Korrelationen af to variabler udregnes ved formlen</p>
<p><span class="math display">\[
cor(X, Y) = \frac{cov(X, Y)}{sd(X) \cdot sd(Y)}
\]</span>
Hvor <span class="math inline">\(cov\)</span> angiver kovariansen og <span class="math inline">\(sd\)</span> angiver standardafvigelsen.</p>
<p>Korrelation fortæller, hvor stor en lineær sammenhæng der er mellem to variabler. Denne værdi ligger i intervallet <span class="math inline">\([-1, 1]\)</span>, hvor <span class="math inline">\(-1\)</span> påviser en perfekt negativ lineær sammenhæng, <span class="math inline">\(1\)</span> påviser en perfekt positiv lineær sammenhæng, og <span class="math inline">\(0\)</span> viser, at der ingen lineær sammenhæng er.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">cor</span>(Z1, Z2)</a></code></pre></div>
<pre><code>## [1] -0.0004757555</code></pre>
<p>Et resultat på afrundet <span class="math inline">\(-0.00048\)</span>, hvilket næsten er 0, viser altså også at der ingen lineær korrelation er mellem <code>Z1</code> og <code>Z2</code>, hvilket giver en indiktion for, at de er uafhængige.</p>
</div>
<div id="pop-sim" class="section level3">
<h3><span class="header-section-number">2.5.4</span> Simulering i R</h3>
<p>I dette afsnit gives eksempler på, hvorledes der kan udføres simuleringer af forskellige fordelinger, således disse fordelinger kan anvendes til statistisk inferens. Afsnittet er primært baseret på kilden <span class="citation">(Peng <a href="#ref-Rsimulation" role="doc-biblioref">2019</a>)</span>.</p>
<!-- Simuleringer i R udføres ved at estimere udfald fra en fordeling, hvor der bliver generet pseudo-tilfældige tal. Disse generede tal forekommer at være tilfældige, men er det reelt set ikke, [@PRNG]. Tallene er genereret ud fra et _seed_, som i R bestemmes ved ```set.seed("værdi")```. Dette _seed_ vil nu angives, så de følgende genereret tal vil være ens, ved nye gennemkørsler. -->
<p>I dataanalysen vil de viste fordelinger bruges som populationer, og stikprøver udtages så ved hjælp af forskellige funktioner. Idéen med denne fremgangsmåde er, at der derved udtages stikprøver fra teoretisk uendelige fordelinger.</p>
<p>Nogle af de fordelinger, der kan simuleres i R, er normal-, binomial-, uniforme-, beta- og gammafordelinger. Alle disse fordelinger har forskellige karateristika, som påvirker hvilke værdier de kan antage. Der vil nu vises eksempler på, hvordan disse fordelinger simuleres i R, og hvordan resultatet vil se ud.</p>
<div id="normalfordeling" class="section level4">
<h4><span class="header-section-number">2.5.4.1</span> Normalfordeling</h4>
<p>I R simuleres en normalfordeling ved funktionen <code>rnorm</code>. Fordelingen på figur @ref(fig:normal) bliver genereret ud fra en middelværdi på <span class="math inline">\(0\)</span> og en standardafvigelse på <span class="math inline">\(1\)</span>.</p>
<div class="figure" style="text-align: center">
<img src="P2-rapport_files/figure-html/normal-1.png" alt="En normalfordeling med størrelsen n = 1000, en middelværdi på 0 og en standardafvigelse på 1. Med disse værdier kaldes den også for en standard normalfordeling eller Z-fordeling" width="672" />
<p class="caption">
(#fig:normal)En normalfordeling med størrelsen n = 1000, en middelværdi på 0 og en standardafvigelse på 1. Med disse værdier kaldes den også for en standard normalfordeling eller Z-fordeling
</p>
</div>
</div>
<div id="uniform-fordeling" class="section level4">
<h4><span class="header-section-number">2.5.4.2</span> Uniform fordeling</h4>
<p>En uniform fordeling er defineret ud fra et interval, som der skal genereres et givent antal værdier indenfor. Alle disse værdier har lige stor sandsynlighed for at blive genereret. Jo større <span class="math inline">\(n\)</span> er, des mere uniformt bliver histogrammet. På figur @ref(fig:unifordeling) ses densitetskurven for en uniform fordeling.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dt">length.out =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw">plot</span>(<span class="dt">x =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="dt">ylab =</span> <span class="st">&quot;Densitet&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>)</a>
<a class="sourceLine" id="cb22-3" title="3"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">1</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="P2-rapport_files/figure-html/unifordeling-1.png" alt="En uniform fordeling, hvor alle tal har lige stor sandsynlighed for at optræde i intervallet [0 , 1]." width="672" />
<p class="caption">
(#fig:unifordeling)En uniform fordeling, hvor alle tal har lige stor sandsynlighed for at optræde i intervallet [0 , 1].
</p>
</div>
</div>
<div id="binomialfordeling" class="section level4">
<h4><span class="header-section-number">2.5.4.3</span> Binomialfordeling</h4>
<p><strong>FIXME</strong> (udbyd beskrivelsen af fordelingen)</p>
<p>En binomialfordeling bliver genereret ud fra sandsynligheder. I den binomiale fordeling gives en <em>size</em> som er antallet af eksperimenter, samt en sandsynlighed for succes, angivet med <em>prob</em>. På figur @ref(fig:binomfordeling) vises densitetskurven af en binomialfordeling.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb23-2" title="2">y &lt;-<span class="st"> </span><span class="kw">dbinom</span>(x, <span class="dt">size =</span> <span class="dv">6</span>, <span class="dt">prob =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb23-3" title="3"><span class="kw">plot</span>(x, y, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">6</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">0.023</span>, <span class="fl">0.6</span>), <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Densitet&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>, </a>
<a class="sourceLine" id="cb23-4" title="4">    <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="P2-rapport_files/figure-html/binomfordeling-1.png" alt="En binomialfordeling med size = 6 og en sandsynlighed for succes på prob = 1/3." width="672" />
<p class="caption">
(#fig:binomfordeling)En binomialfordeling med size = 6 og en sandsynlighed for succes på prob = 1/3.
</p>
</div>
<p>En egenskab ved binomialfordelinger er, at jo højere <span class="math inline">\(n\)</span> er, des tættere vil middelværdien af stikprøven være på sandsynligheden for succes.</p>
</div>
<div id="skæve-fordelinger" class="section level4">
<h4><span class="header-section-number">2.5.4.4</span> Skæve fordelinger</h4>
<p>En skæv fordeling er kendetegnet ved, at størstedelen af observationerne er samlet omkring visse værdier, mens de resterende observationer fordeler sig ud til kun én af siderne. De resterende observationer kaldes for “halen” af fordelingen, og alt efter retningen af dem, kaldes den skæve fordeling for “venstreskæv” elller “højreskæv”.</p>
</div>
<div id="betafordeling" class="section level4">
<h4><span class="header-section-number">2.5.4.5</span> Betafordeling</h4>
<p>En skæv fordeling kan være en betafordeling, <span class="math inline">\(\text{Beta}(\alpha, \beta)\)</span>, hvor <span class="math inline">\(\alpha-1\)</span> angiver andelen af succeser og <span class="math inline">\(\beta-1\)</span> angiver andelen af fiaskoer. Betafordelingen er tilnærmelsesvis normaltfordelt, hvis <span class="math inline">\(\alpha\)</span> og <span class="math inline">\(\beta\)</span> begge er tilpas store og omtrent ens, <span class="citation">(Kim <a href="#ref-TDSBeta" role="doc-biblioref">2020</a>)</span>.</p>
<p>En venstreskæv og en højreskæv betafordeling vil nu simuleres og vises på figur @ref(fig:betafordeling), hvor <span class="math inline">\(\alpha = 8\)</span> og <span class="math inline">\(\beta = 2\)</span> for den venstreskæve, mens <span class="math inline">\(\alpha = 2\)</span> og <span class="math inline">\(\beta = 8\)</span> for den højreskæve.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb24-2" title="2">y1 &lt;-<span class="st"> </span><span class="kw">dbeta</span>(x, <span class="dt">shape1 =</span> <span class="dv">2</span>, <span class="dt">shape2 =</span> <span class="dv">8</span>)</a>
<a class="sourceLine" id="cb24-3" title="3">y2 &lt;-<span class="st"> </span><span class="kw">dbeta</span>(x, <span class="dt">shape1 =</span> <span class="dv">8</span>, <span class="dt">shape2 =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb24-4" title="4"></a>
<a class="sourceLine" id="cb24-5" title="5"><span class="kw">plot</span>(x, y1, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Densitet&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb24-6" title="6"><span class="kw">lines</span>(x, y2, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb24-7" title="7"><span class="kw">legend</span>(<span class="fl">0.35</span>, <span class="dv">3</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;alfa = 2, beta = 8 &quot;</span>, <span class="st">&quot;alfa = 8, beta = 2&quot;</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, </a>
<a class="sourceLine" id="cb24-8" title="8">    <span class="st">&quot;red&quot;</span>), <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">cex =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="P2-rapport_files/figure-html/betafordeling-1.png" alt="To betafordelinger med henholdsvis alfa = 8 og beta = 2, og alfa = 2 og beta = 8." width="672" />
<p class="caption">
(#fig:betafordeling)To betafordelinger med henholdsvis alfa = 8 og beta = 2, og alfa = 2 og beta = 8.
</p>
</div>
</div>
<div id="gammafordeling" class="section level4">
<h4><span class="header-section-number">2.5.4.6</span> Gammafordeling</h4>
<p>Gammafordelingen er ligeledes en skæv fordeling. Funktionaliteten af gammafordelingen er at forudsige ventetiden til den <span class="math inline">\(\alpha\)</span>’te begivenhed. Tæthedsfunktionen for gammafordelingen, er beskrevet med to forskellige parametersæt, henholdsvis <span class="math inline">\((k,~\theta)\)</span> og <span class="math inline">\((\alpha,~\beta)\)</span>. I denne rapport vil der fremefter blive anvendt parameterne <span class="math inline">\((\alpha,~\beta)\)</span>. Tæthedsfuktionen er givet ved <span class="math inline">\(f(x)=\frac{\beta^{\alpha}}{\Gamma(\alpha)}x^{\alpha-1}e^{-\beta x}\)</span>, hvor <span class="math inline">\(\alpha &gt; 0\)</span> er “shape”, <span class="math inline">\(\beta &gt; 0\)</span> er “rate” og <span class="math inline">\(x \in ( 0, \infty)\)</span>, <span class="citation">(Kim <a href="#ref-Gammadist" role="doc-biblioref">2019</a>)</span>. På figur @ref(fig:gammafordeling) er vist tre forskellige højreskæve gammafordelinger.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">25</span>, <span class="dt">length.out =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb25-2" title="2">y1 &lt;-<span class="st"> </span><span class="kw">dgamma</span>(x, <span class="dt">shape =</span> <span class="dv">1</span>, <span class="dt">rate =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb25-3" title="3">y2 &lt;-<span class="st"> </span><span class="kw">dgamma</span>(x, <span class="dt">shape =</span> <span class="dv">5</span>, <span class="dt">rate =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb25-4" title="4">y3 &lt;-<span class="st"> </span><span class="kw">dgamma</span>(x, <span class="dt">shape =</span> <span class="dv">10</span>, <span class="dt">rate =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb25-5" title="5"><span class="kw">plot</span>(x, y1, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Densitet&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb25-6" title="6"><span class="kw">lines</span>(x, y2, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb25-7" title="7"><span class="kw">lines</span>(x, y3, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>)</a>
<a class="sourceLine" id="cb25-8" title="8"><span class="kw">legend</span>(<span class="dv">20</span>, <span class="fl">0.8</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;alfa = 1&quot;</span>, <span class="st">&quot;alfa = 5&quot;</span>, <span class="st">&quot;alfa = 10&quot;</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, </a>
<a class="sourceLine" id="cb25-9" title="9">    <span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>), <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">cex =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="P2-rapport_files/figure-html/gammafordeling-1.png" alt="Tre gammafordelinger hvor beta = 1 og alfa på henholdsvis 1, 5 og 10." width="672" />
<p class="caption">
(#fig:gammafordeling)Tre gammafordelinger hvor beta = 1 og alfa på henholdsvis 1, 5 og 10.
</p>
</div>
</div>
</div>
<div id="repetitioner" class="section level3">
<h3><span class="header-section-number">2.5.5</span> Repetitioner</h3>
<p>I nogle statistiske metoder er det nødvendigt at arbejde med flere stikprøver end kun én enkelt. Med funktionen <code>replicate</code> i R, kan der genereres adskillige nye stikprøver ud fra den oprindelige. Processen med <em>replicate</em> vil nu vises. Først ses en stikprøve med tre observationer.</p>
<pre><code>##               Oprindelig stikprøve
## Observation 1           -1.2833712
## Observation 2           -1.2634498
## Observation 3            0.2146729</code></pre>
<p><em>Replicate</em>-funktionen vil nu bruges. I alt replikeres der fem gange, hvilket betyder, at der bliver oprettet fem nye stikprøver. I forbindelse med denne process anvendes funktionen <code>sample</code>, som er funktionen der <em>resampler</em>, enten med eller uden tilbagelægning fra stikprøven. I dette eksempel bruges funktionen med tilbagelægning. Fra den oprindelige stikprøve udtrækkes en observation, som indsættes i en ny stikprøve. Observationeren bliver derefter lagt tilbage i den oprindelige stikprøve, dette medfører at den samme observation kan udtages flere gange. Grunden til dette er, at stikprøven anses for at være repræsentativ for population, og to observationer af den samme værdi derfor ikke er utænkelig.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">ny_stik &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">5</span>, {</a>
<a class="sourceLine" id="cb27-2" title="2">    <span class="co"># Der replikeres 5 gange</span></a>
<a class="sourceLine" id="cb27-3" title="3">    <span class="kw">sample</span>(stik, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb27-4" title="4">})</a>
<a class="sourceLine" id="cb27-5" title="5">ny_stik</a></code></pre></div>
<pre><code>##            [,1]      [,2]       [,3]       [,4]       [,5]
## [1,]  0.2146729 -1.283371 -1.2634498 -1.2833712  0.2146729
## [2,]  0.2146729 -1.263450 -1.2634498  0.2146729  0.2146729
## [3,] -1.2634498 -1.263450  0.2146729  0.2146729 -1.2634498</code></pre>
<p>Funktionen har nu resamplet fem nye repræsentative stikprøver udfra den oprindelige. Denne metode og dens anvendelser vil der kigges nærmere på kapitel @ref(boot-afsnit).</p>
</div>
</div>
<div id="problemformulering" class="section level2">
<h2><span class="header-section-number">2.6</span> Problemformulering</h2>
<p><em>Kan simuleringsstudier bidrage til at højne kvaliteten af dataanalyser, og i så fald, hvordan?</em></p>
<ol style="list-style-type: decimal">
<li><p>Hvilke faldgruber skal man være opmærksom på ved hypotesetest?</p></li>
<li><p>Hvordan simulerer en computer data?</p></li>
<li><p>Hvordan kan teoretiske resultater eftervises ved hjælp af simulering?</p></li>
</ol>
<p><strong>FIXME:</strong> arbejdsspørgsmål i samme rækkefølge som i rapporten. Ret løbende.</p>
<!--chapter:end:02-Problemanalyse.Rmd-->
<!-- # Resampling-metoder -->
<!-- I de følgende to underafsnit beskrives to metoder, der er yderst relevante når der arbejdes med statistik. Først vil der ses på permutationstest, og hvordan, permutationer af data kan udnyttes i forskellige test. Derefter vil der blive redegjort for en resampling-metode kaldet bootstrap, hvis anvendelser, der vil undersøges nærmere senere i rapporten. -->
</div>
</div>
<div id="permutationstest" class="section level1">
<h1><span class="header-section-number">3</span> Permutationstest</h1>
<p>I afsnit @ref(t-test) blev der redegjort for visse antagelser, der skal være opfyldt, for at en t-test giver retvisende resultater. Ligeledes blev der i afsnit @ref(t-test2) vist hvorledes en t-tests resultater kan være misvisendende, hvis stikprøverne ikke er normalfordelte.
I dette afsnit vil der redegøres for en løsning til dette problem. Hvis antagelserne ikke er opfyldte, og en t-test ikke kan anvendes, kan der udnyttes permutationstest. Først vil der gives en kort introduktion til permutationer, herefter en forklaring af, hvad en permutationstest er, og til sidst et praktisk eksempel.</p>
<div id="permutationer" class="section level2">
<h2><span class="header-section-number">3.1</span> Permutationer</h2>
<p>I dette afsnit defineres permutationer, og der gives et kort eksempel på en permutation af en ordnet liste af tre elementer. Afsnittet er skrevet på baggrund af <span class="citation">(Weisstein <a href="#ref-Permutationer" role="doc-biblioref">2020</a><a href="#ref-Permutationer" role="doc-biblioref">b</a>)</span>.</p>
<p>Givet en ordnet liste, <span class="math inline">\(X = [x_1, x_2, \ldots, x_n ]\)</span>, er en permutation, <span class="math inline">\(\pi\)</span>, en omarrangering af listens elementer, <span class="math inline">\(X_\pi = [x_{\pi(1)}, x_{\pi(2)}, \ldots, x_{\pi(n)}]\)</span>. Antallet af mulige permutationer af en ordnet liste, <span class="math inline">\(X\)</span>, af længde <span class="math inline">\(n\)</span>, er givet ved <span class="math inline">\(n!\)</span>.</p>
<p>Som eksempel, er en mulig permutation, <span class="math inline">\(\pi_1\)</span>, af <span class="math inline">\(A = [1, 2, 3]\)</span> givet ved <span class="math inline">\(A_{\pi_1} = [2, 1, 3]\)</span>, og der er i alt <span class="math inline">\(|A| = 3! = 1 \cdot 2 \cdot 3 = 6\)</span> mulige permutationer af listen.</p>
</div>
<div id="test-ved-hjælp-af-permutationer" class="section level2">
<h2><span class="header-section-number">3.2</span> Test ved hjælp af permutationer</h2>
<p>I dette afsnit gives en forklaring af, hvad en permutationstest er. Afsnittet er skrevet på baggrund af <span class="citation">(Giles <a href="#ref-Permutationstest" role="doc-biblioref">2019</a>)</span>.</p>
<p>Antag, at en tilfældig stikprøveudtagning af en population kan udtrykkes ved <span class="math inline">\(X = [x_1, x_2, \ldots, x_n]\)</span>. Der opstilles en nulhypotese <span class="math inline">\(H_0\)</span> og en alternativ hypotese, <span class="math inline">\(H_1\)</span>, der er relevante at undersøge. Der kan så vælges en teststørrelse at undersøge for at teste validiteten af <span class="math inline">\(H_0\)</span>. Værdien af denne teststørrelse er givet ved <span class="math inline">\(S_{obs}\)</span> for stikprøven.</p>
<p>En permutationstest går ud på at forsøge at måle evidens imod <span class="math inline">\(H_0\)</span>, som i en almindelig t-test. Dette gøres ved at beregne teststørrelsen for samtlige permutationer af <span class="math inline">\(X\)</span>. Denne mængde af permutationer er givet ved <span class="math inline">\(\Pi_X = \{X_{\pi(1)}, X_{\pi(2)}, \ldots X_{\pi(m)} \}\)</span>, hvor <span class="math inline">\(m\)</span> er antallet af mulige permutationer af <span class="math inline">\(X\)</span>. Teststørrelsen for den <span class="math inline">\(i\)</span>’te permutation benævnes <span class="math inline">\(S_{\pi_i}\)</span>.</p>
<p>Ved nu at undersøge, hvor stor en andel af <span class="math inline">\(S_{\pi_i}\)</span>, der har en mere ekstrem værdi end <span class="math inline">\(S_{obs}\)</span>, findes en <em>p</em>-værdi for testen. Dette kan skrives som <span class="math inline">\(p = \frac{\# S_{\pi_i}~ \text{mere ekstrem end}~ S_{obs}}{m}\)</span>.</p>
<p>Denne form for test har den fordel, at den antager meget lidt omkring stikprøven. I særdeleshed antager den hverken tilfældig stikprøveudtagning, eller at populationen, fra hvilken stikprøven stammer, er normalfordelt. Der er dog visse ulemper ved en permutationstest. For det første, skal det antages, at den del af data, der permuteres, er ombyttelig. For det andet er det ikke alle teststørrelser, der kan testes ved hjælp af en permutationstest - for eksempel vil middelværdien af samtlige permutationer være lig hinanden. For det tredje bliver antallet af mulige permutationer hurtigt meget stor, når størrelsen af stikprøven stiger - hvis der for eksempel er <span class="math inline">\(n = 10\)</span> datapunkter i stikprøven, vil der være <span class="math inline">\(10! = 3,628,800\)</span> mulige permutationer af stikprøven.</p>
<p>Netop på grund af ombytteligheden af stikprøven, fungerer permutationstests. Hvis stikprøven er ombyttelig, vil hver eneste permutation af stikprøven, inklusiv stikprøven selv, være lige sandsynlige. Dette medfører, at hvis <span class="math inline">\(H_0\)</span> er sand, vil enhver difference imellem <span class="math inline">\(S_{obs}\)</span> og <span class="math inline">\(S_{\pi_i}\)</span> være lille og tilfældig. Hvis værdien for <span class="math inline">\(S_{obs}\)</span> på den måde konkluderes at være væsentlig anderledes, tyder det på, at <span class="math inline">\(H_0\)</span> skal forkastes.</p>
<p>Det store antal af permutationer afhjælpes ved kun at beregne <span class="math inline">\(S_{\pi_i}\)</span> for et passende antal, tilfældigt udvalgte, permutationer af stikprøven, og et acceptabelt resultat vil stadig blive opnået.</p>
<p><strong>Eksempel</strong></p>
<p>Der vil nu vises et eksempel på hvordan permutationstest kan anvendes som en hypotesetest. Antag, at det ønskes undersøgt, om middelværdien af en to stikprøver er signifikant anderledes. Den opstillet nulhypotese bliver <span class="math inline">\(H_0 : \mu_1 = \mu_2\)</span>, og den alternative hypotese bliver <span class="math inline">\(H_1 : \mu_1 \neq \mu_2\)</span>.</p>
<p>Der vil blive udtrækket to stikprøver fra den samme betafordeling, der vises på figur @ref(fig:permhist).</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">set.seed</span>(<span class="dv">29</span>)</a>
<a class="sourceLine" id="cb29-2" title="2"></a>
<a class="sourceLine" id="cb29-3" title="3">n =<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb29-4" title="4">stik1 &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n, <span class="dv">8</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb29-5" title="5">stik2 &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n, <span class="dv">8</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb29-6" title="6"></a>
<a class="sourceLine" id="cb29-7" title="7">mean_difference &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">mean</span>(stik1) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(stik2))</a></code></pre></div>
<p>Den obsereveret forskel i middelværdien mellem de to stikprøver ses at være <code>0.0124786</code>.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb30-2" title="2"><span class="kw">hist</span>(stik1, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Antal observationer&quot;</span>)</a>
<a class="sourceLine" id="cb30-3" title="3"><span class="kw">hist</span>(stik2, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Antal observationer&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="P2-rapport_files/figure-html/permhist-1.png" alt="To stikprøver udtrukket fra den samme betafordeling med parameterne alpha = 8 og beta = 2." width="672" />
<p class="caption">
(#fig:permhist)To stikprøver udtrukket fra den samme betafordeling med parameterne alpha = 8 og beta = 2.
</p>
</div>
<p>Den obsereveret forskel i middelværdien mellem de to stikprøver ses at være <code>0.0124786</code>.
Teststørrelsen vil i dette tilfælde være forskellen mellem stikprøvernes middelværdi, <span class="math inline">\(S_{obs} = |\hat{\mu}_1 - \hat{\mu}_2|\)</span>. Hvorvidt denne forskel er signifikant kan nu undersøges ved at beregne forskellen i middelværdi for samtlige permutationer af stikprøverne. Observationerne fra hver stikprøve vil blive forenet i en enkelt stikprøve, som der vil permuteres udfra.</p>
<p>I nedenstående kode udføres der 100 permutationer på den forenet stikprøve, med en størrelse på i alt <span class="math inline">\(n = 200\)</span>. I hver permutation udtrækkes de første 100 observationer til at være en permuteret stikprøve 1, mens de sidste 100 observationer bliver til den permuteret stikprøve 2.
Derefter udregnes den absolutte forskel i middelværdien mellem de nye permuteret stikprøver, i alt 100 gange, en for hver permutation.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">library</span>(gtools)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;gtools&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:e1071&#39;:
## 
##     permutations</code></pre>
<pre><code>## The following object is masked from &#39;package:mosaic&#39;:
## 
##     logit</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">mean_list &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb35-2" title="2">forenet_stik &lt;-<span class="st"> </span><span class="kw">c</span>(stik1, stik2)</a>
<a class="sourceLine" id="cb35-3" title="3"></a>
<a class="sourceLine" id="cb35-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) {</a>
<a class="sourceLine" id="cb35-5" title="5">    permuteret_forenet_stik &lt;-<span class="st"> </span><span class="kw">permute</span>(forenet_stik)</a>
<a class="sourceLine" id="cb35-6" title="6">    permuteret_stik1 &lt;-<span class="st"> </span><span class="kw">head</span>(permuteret_forenet_stik, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb35-7" title="7">    permuteret_stik2 &lt;-<span class="st"> </span><span class="kw">tail</span>(permuteret_forenet_stik, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb35-8" title="8">    </a>
<a class="sourceLine" id="cb35-9" title="9">    mean_list[i] &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">mean</span>(permuteret_stik1) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(permuteret_stik2))</a>
<a class="sourceLine" id="cb35-10" title="10">}</a>
<a class="sourceLine" id="cb35-11" title="11"><span class="kw">head</span>(mean_list, <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 0.013359260 0.013294550 0.001433817</code></pre>
<p>I outputtet <em>head(mean_list, 3)</em> ses et eksempel på tre af middelværdierne, som der er i alt 100 af.
På figur @ref(fig:permmeanhist) illusteres fordelingen af alle permutationernes teststørrelse.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">hist</span>(mean_list, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Antal observationer&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Forskel i middelværdier&quot;</span>)</a>
<a class="sourceLine" id="cb37-2" title="2"><span class="kw">abline</span>(<span class="dt">v =</span> mean_difference, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="P2-rapport_files/figure-html/permmeanhist-1.png" alt="Permutationsfordelingen af alle teststørrelserne. Den blå linje viser den originale observeret forskel i middelværdierne." width="672" />
<p class="caption">
(#fig:permmeanhist)Permutationsfordelingen af alle teststørrelserne. Den blå linje viser den originale observeret forskel i middelværdierne.
</p>
</div>
<p>Nu kan p-værdien beregnes, ved at udregne hvor mange gange den observeret forskel mellem middelværdierne på hver permutationstest er større end den originale obserevet forskel. Denne værdi divideres derefter med antallet af permutationer der er udført i alt. Dette gøres i nedenstående kodestykke.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">extreme_values &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb38-2" title="2"></a>
<a class="sourceLine" id="cb38-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(mean_list)) {</a>
<a class="sourceLine" id="cb38-4" title="4">    <span class="cf">if</span> (mean_list[i] <span class="op">&gt;=</span><span class="st"> </span>mean_difference) {</a>
<a class="sourceLine" id="cb38-5" title="5">        extreme_values &lt;-<span class="st"> </span>extreme_values <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb38-6" title="6">    }</a>
<a class="sourceLine" id="cb38-7" title="7">}</a>
<a class="sourceLine" id="cb38-8" title="8">p_value &lt;-<span class="st"> </span>extreme_values<span class="op">/</span><span class="kw">length</span>(mean_list)</a>
<a class="sourceLine" id="cb38-9" title="9">p_value</a></code></pre></div>
<pre><code>## [1] 0.57</code></pre>
<p>Med en p-værdi på <code>0.57</code>, er der ikke noget belæg for at forkaste nulhypotesen.</p>
<p><strong>Antal type-I fejl</strong></p>
<p>Antallet af type-I fejl der opstår i en permutationstest kan undersøges ved at se hvor mange gange <span class="math inline">\(H_0\)</span> forkastes, selvom <span class="math inline">\(H_0\)</span> er sand. I virkeligheden burde antallet af type-I fejl svare til det valgte signifikansniveau, <span class="citation">(Agresti and Finlay <a href="#ref-ASTAbog" role="doc-biblioref">2014</a>, s. 156-157)</span>.</p>
<p>Processen for at finde antallet af type-1 fejl er den samme som i det forrige eksempel. Forskellen er <strong>FIXME</strong></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">res &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, {</a>
<a class="sourceLine" id="cb40-2" title="2">    </a>
<a class="sourceLine" id="cb40-3" title="3">    n =<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb40-4" title="4">    stik3 &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n, <span class="dv">8</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb40-5" title="5">    stik4 &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n, <span class="dv">8</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb40-6" title="6">    samlet_stik &lt;-<span class="st"> </span><span class="kw">c</span>(stik3, stik4)</a>
<a class="sourceLine" id="cb40-7" title="7">    </a>
<a class="sourceLine" id="cb40-8" title="8">    mean_difference &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">mean</span>(stik3) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(stik4))</a>
<a class="sourceLine" id="cb40-9" title="9">    perm_samples &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> <span class="dv">10</span>, <span class="dt">ncol =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb40-10" title="10">    mean_list &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb40-11" title="11">    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) {</a>
<a class="sourceLine" id="cb40-12" title="12">        perm_samples[, i] &lt;-<span class="st"> </span><span class="kw">sample</span>(samlet_stik, <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb40-13" title="13">    }</a>
<a class="sourceLine" id="cb40-14" title="14">    </a>
<a class="sourceLine" id="cb40-15" title="15">    mean_list &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb40-16" title="16">    </a>
<a class="sourceLine" id="cb40-17" title="17">    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) {</a>
<a class="sourceLine" id="cb40-18" title="18">        mean_list[i] &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">mean</span>(perm_samples[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, i]) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(perm_samples[<span class="dv">6</span><span class="op">:</span><span class="dv">10</span>, </a>
<a class="sourceLine" id="cb40-19" title="19">            i]))</a>
<a class="sourceLine" id="cb40-20" title="20">    }</a>
<a class="sourceLine" id="cb40-21" title="21">    </a>
<a class="sourceLine" id="cb40-22" title="22">    extreme_values &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb40-23" title="23">    </a>
<a class="sourceLine" id="cb40-24" title="24">    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(mean_list)) {</a>
<a class="sourceLine" id="cb40-25" title="25">        <span class="cf">if</span> (mean_list[i] <span class="op">&gt;=</span><span class="st"> </span>mean_difference) {</a>
<a class="sourceLine" id="cb40-26" title="26">            extreme_values &lt;-<span class="st"> </span>extreme_values <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb40-27" title="27">        }</a>
<a class="sourceLine" id="cb40-28" title="28">    }</a>
<a class="sourceLine" id="cb40-29" title="29">    p_value &lt;-<span class="st"> </span>extreme_values<span class="op">/</span><span class="kw">length</span>(mean_list)</a>
<a class="sourceLine" id="cb40-30" title="30">    </a>
<a class="sourceLine" id="cb40-31" title="31">    </a>
<a class="sourceLine" id="cb40-32" title="32">    type1fejl &lt;-<span class="st"> </span>p_value <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb40-33" title="33">    <span class="kw">return</span>(type1fejl)</a>
<a class="sourceLine" id="cb40-34" title="34">})</a>
<a class="sourceLine" id="cb40-35" title="35"><span class="kw">table</span>(res)</a></code></pre></div>
<pre><code>## res
## FALSE  TRUE 
##    29   971</code></pre>
<p>I alt forkastes <strong>FIXME</strong></p>
<!--chapter:end:04-Permutation.Rmd-->
</div>
</div>
<div id="boot-afsnit" class="section level1">
<h1><span class="header-section-number">4</span> Bootstrap</h1>
<p>I dette kapitel vil den teoretiske del af bootstrap blive beskrevet og hvordan der udtages bootstrap-stikprøver. Herefter vil der blive undersøgt, hvordan bootstrap kan anvendes i praksis til at udregne standardfejl for en estimator, hvordan hypotesetest udføres ved hjælp af bootstrap og til at angive konfidensintervaller. Til hver anvendelse vil der også blive givet et eksempel på metoden.</p>
<div id="ikke-parametrisk-bootstrap" class="section level2">
<h2><span class="header-section-number">4.1</span> Ikke-parametrisk bootstrap</h2>
<p>Der findes forskellige bootstrap-metoder, som varierer på forskellige punkter. Valget af bootstrap-metode afhænger af den individuelle situation, hvor der skal udføres statistisk inferens. Der gøres opmærksom på, at i den resterende del af rapporten, vil ordet bootstrap henvise til den ikke-parametriske bootstrap-metode. Ikke-parametrisk bootstrap, er når der ikke sættes specifikke antagelser eller en præcis model for populationen, når undersøgelsen udføres. Derimod antages det, at en stikprøve er repræsentativ for hele populationen, <span class="citation">(Berrar <a href="#ref-nonparaboot" role="doc-biblioref">2019</a>, side 3)</span>.</p>
<p>Bootstrap er en resampling-metode, der bruges til at generere yderligere datasæt ud fra den givne stikprøve, hvor målet er at udføre statistisk inferens for en valgt teststørrelse. For eksempel kan bootstrap give et indblik i tendenser for teststørrelsen, såsom standardfejlen og forventningsrethed, eller udregne konfidensintervaller. Der gøres opmærksom på, at bootstrap ikke kan bruges til at få et bedre estimat for parameteren, da bootstrap-fordelingen er centreret omkring stikprøvens estimat, se Figur @ref(fig:fig-boot-fordeling), for eksempel middelværdien <span class="math inline">\(\hat {\mu}\)</span>, og ikke populationens middelværdi, <span class="math inline">\(\mu\)</span>, <span class="citation">(Laura M Chihara and Hesterberg <a href="#ref-BootvsJack" role="doc-biblioref">2019</a> s. 114)</span>.</p>
<div class="figure" style="text-align: center">
<img src="P2-rapport_files/figure-html/fig-boot-fordeling-1.png" alt="(a) Populationens fordeling,  N(23, 49). (b) Fordelingen på en stikprøve af størrelsen 50. (c) Den teoretiske fordeling af stikprøvens middelværdi. (d) Fordelingen af bootstrap-stikprøvernes middelværdi. De stiplede linjer representerer middelværdien, [@MathStat, side 108]." width="90%" />
<p class="caption">
(#fig:fig-boot-fordeling)(a) Populationens fordeling, N(23, 49). (b) Fordelingen på en stikprøve af størrelsen 50. (c) Den teoretiske fordeling af stikprøvens middelværdi. (d) Fordelingen af bootstrap-stikprøvernes middelværdi. De stiplede linjer representerer middelværdien, <span class="citation">(Laura M. Chihara and Hesterberg <a href="#ref-MathStat" role="doc-biblioref">2019</a>, side 108)</span>.
</p>
</div>
<!-- ```{r, out.width='75%', fig.align='center', fig.cap="(a) Populationsfordelingen, N(23, 49). (b) Fordelingen på en stikprøve af størrelsen 50. (c) Den teoretiske fordeling af stikprøvefordelingen bar{X}, N(23, 49/50). (d) Bootstrap fordelingen baseret på den stikprøve. De stiplede linjer representerer middelværdien [@MathStat, side 108]", echo = FALSE} -->
<!-- knitr::include_graphics("images/Bootstrap_fordelinger.png") -->
<!-- ``` -->
<p>Hver bootstrap-stikprøve har størrelsen <span class="math inline">\(n\)</span>, altså den samme størrelse som stikprøven. Bootstrap opererer med tilbagelægning, så der er en sandsynlighed for, at et givent datapunkt bliver udtaget mere end en gang. Samtidig er der en sandsynlighed for, at et datapunkt slet ikke bliver udvalgt. Det er relevant at undersøge, hvor mange af de oprindelige observationer, som i gennemsnit medtages i nye bootstrap-stikprøver, og ligeledes, hvor mange, som udelades.</p>
<p>Sandsynligheden for, at en specifik observation ikke udtages fra de oprindelige <span class="math inline">\(n\)</span> observationer, er <span class="math inline">\(1-1/n\)</span>, og sandsynligheden for, at denne observation ikke udtages <span class="math inline">\(n\)</span> gange er <span class="math inline">\((1-1/n)^n\)</span>. Når stikprøvestørrelsen, <span class="math inline">\(n\)</span>, går mod uendeligt gælder, at <span class="math inline">\((1-1/n)^n = 1/e \approx 0.368\)</span>. Derfor vil en bootstrap-stikprøve af tilpas stor størrelse indeholde <span class="math inline">\(\approx 63.2\%\)</span> observationer fra den oprindelige stikprøve, og udelade <span class="math inline">\(\approx 36.8\%\)</span>, <span class="citation">(Wicklin <a href="#ref-SAS" role="doc-biblioref">2017</a>)</span>.</p>
<p>I alt bliver der genereret <span class="math inline">\(B\)</span> bootstrap-stikprøver, som der hver især udføres statistisk inferens på. Med den computerkraft der er tilgængelig i dag, anbefales der af kilden, <span class="citation">(Marin <a href="#ref-BootYouTube1" role="doc-biblioref">2018</a>)</span>, mindst <span class="math inline">\(10,000\)</span> resamples, derved <span class="math inline">\(B \geq 10,000\)</span>, for at få et nøjagtigt estimat. Grunden til, at der ikke genereres et endnu større antal bootstrap-stikprøver end de <span class="math inline">\(10,000\)</span> er, at bootstrap-stikprøven generes ud fra den obseverede data. Et større <span class="math inline">\(B\)</span> vil derfor ikke medføre yderligere information om populationen, men vil dog medvirke til et mere præcist estimat, <span class="citation">(Marin <a href="#ref-BootYouTube1" role="doc-biblioref">2018</a>, 10:20)</span>.</p>
<p>Fordelen ved bootstrap er, at selvom der kun er én tilgængelig stikprøve fra den underliggende population, er der stadig mulighed for at estimere stikprøvefordelingen, uden at der kræves yderligere stikprøver fra populatonen. Dette skyldes netop antagelsen om, at stikprøven skal være repræsentativ for populationen.</p>
<div class="figure" style="text-align: center">
<img src="images/normalvboot.PNG" alt="Her er illustreret forskellen mellem at finde den teoretiske stikprøvefordeling ved hjælp af mange stikprøver fra populationen (orange), og måden hvorpå stikprøvefordelingen kan findes ved hjælp af kun én stikprøve, der udføres bootstrap på (grøn)." width="75%" />
<p class="caption">
(#fig:figur-Bootstrap-illustration)Her er illustreret forskellen mellem at finde den teoretiske stikprøvefordeling ved hjælp af mange stikprøver fra populationen (orange), og måden hvorpå stikprøvefordelingen kan findes ved hjælp af kun én stikprøve, der udføres bootstrap på (grøn).
</p>
</div>
<p>Der er to hovedårsager til at benytte bootstrap, som beskrevet i <span class="citation">(Marin <a href="#ref-BootYouTube1" role="doc-biblioref">2018</a>)</span>. For det første, hvis stikprøven ikke er tilpas stor, og stikprøvefordelingen derfor heller ikke kan antages at være normalfordelt. For det andet, hvis metoden til at beregne teststørrelsens standardfejl er teoretisk avanceret. Eksempelvis er standardfejlen for middelværdien nem at løse, <span class="math inline">\(\hat{\text{se}}(\hat{\mu}) = \frac{S}{\sqrt{n}}\)</span>, mens det ikke er tilfældet, hvis det i stedet er afstanden mellem to percentiler, der estimeres.</p>
<!--chapter:end:05-Bootstrap.Rmd-->
<!-- # Bootstrap anvendelser -->
<!-- I dette kapitel, vil der blive undersøgt hvordan bootstrap kan anvendes i praksis. Herunder, når der skal udregnes standardfejl for en estimator, til at angive konfidensintervaller, samt hvis der skal udføres hypotesetest vha. bootstrap. Til hver anvendelse, vil der også blive givet et eksempel på dataanalyse.  -->
</div>
<div id="bootstrap-standardfejl" class="section level2">
<h2><span class="header-section-number">4.2</span> Bootstrap-standardfejl</h2>
<p>Der vil i dette afsnit beskrives, hvordan standardfejl af en bootstrap-stikprøve udregnes. I det efterfølgende afsnit vil standardfejlen inddrages i beregningen af konfidensintervallet for en bootstrap-stikprøve. Det følgende afsnit er primært skrevet på baggrund af <span class="citation">(Yen <a href="#ref-TDSBootstrap" role="doc-biblioref">2019</a>)</span>.</p>
<p>Standardafvigelsen for en estimator beskrives som estimatorens standardfejl. Standardfejlen er et udtryk for, hvor stor en afvigelse der er fra populationens parameter til stikprøvens estimat. Jo mindre standardfejlen er, desto mindre er afvigelsen mellem estimatet og parameteren. Som udgangspunkt vil en stikprøves estimat aldrig være lig populationens parameter, fordi der ved udtagning af en stikprøve, i hvert tilfælde vil være variabilitet. Standardfejlen er et mål for denne variabilitet.</p>
<p>Som eksempel vil standardfejlen for estimatet af middelværdien, <span class="math inline">\(\hat{\mu}\)</span>, være <span class="math inline">\(\text{se}(\hat{\mu}) = \frac{\sigma}{\sqrt{n}}\)</span>.</p>
<p>Når der arbejdes med data udover det teoretiske, vil standardafvigelsen for populationen, <span class="math inline">\(\sigma\)</span>, altid være ukendt. Derfor bruges stikprøvens estimat for standardafvigelsen, <span class="math inline">\(S\)</span> til at beregne den estimerede standardfejl, <span class="math inline">\(\hat{\text{se}}\)</span>.</p>
<p>Som eksempel vil den estimerede standardfejl for estimatet af middelværdien, <span class="math inline">\(\hat{\mu}\)</span>, være <span class="math inline">\(\hat{\text{se}}(\hat{\mu}) = \frac{S}{\sqrt{n}}\)</span>, hvor <span class="math inline">\(S = \sum_{i=1}^{n} \frac{(x_i - \hat{\mu})^2}{n - 1}\)</span> er stikprøvens standardafvigelse for middelværdien, og <span class="math inline">\(n\)</span> er størrelsen på stikprøven.</p>
<p>Såfremt en estimator er normalfordelt eller tilnærmelsesvist er normalfordelt, kan det forventes, at et estimat vil være mindre end én standardfejl fra det forventede i <span class="math inline">\(68\%\)</span> af tilfældene og mindre end to standardfejl fra i <span class="math inline">\(95\%\)</span> af tilfældene.</p>
<p>Dog er dette ikke altid ligetil i virkeligheden, oftest er der ikke tilstrækkelig informationer om populationen eller fordeligen af denne. Samtidig kræver det, at der er nogle specifikke krav som er opfyldt. Disse problemer kan undgås ved at benytte bootstrap til at estimere standardfejlen, givet ved nedstående formel.</p>
<p><span class="math display">\[se(\hat{\theta}) = \sqrt{\frac{1}{B-1}\sum_{b=1}^{B}(\hat{\theta_b^*} - \bar{\theta} )^2}\]</span></p>
<p>Hvor <span class="math inline">\(\hat{\theta}\)</span> er stikprøvens estimat for den ønskede parameter, <span class="math inline">\(B\)</span> er antal bootstrap-stikprøver, <span class="math inline">\(\hat\theta_b^*\)</span> er estimatet for den <span class="math inline">\(b\)</span>’te bootstrap-stikprøve og <span class="math inline">\(\bar{\theta} = (\frac{1}{B}) \sum_{b=1}^{B}\hat{\theta_b^*}\)</span>, <span class="citation">(Bartlett <a href="#ref-BootMiracle" role="doc-biblioref">2013</a>)</span>.</p>
<p><strong>Eksempel</strong></p>
<p>I kodetstykket nedenfor laves en tilfældig population med en standard normalfordeling. Ud fra populationen udtages en tilfældig stikprøve. Der udregnes standardfejlen for stikprøven. Derefter laves <span class="math inline">\(10,000\)</span> bootstrap-stikprøver, hvor standardfejlen for bootstrap-stikprøven udrenges.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="kw">set.seed</span>(<span class="dv">11</span>)</a>
<a class="sourceLine" id="cb42-2" title="2">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb42-3" title="3"></a>
<a class="sourceLine" id="cb42-4" title="4">sample_pop &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)  <span class="co"># Stikprøve fra populationen</span></a>
<a class="sourceLine" id="cb42-5" title="5">SD_sample &lt;-<span class="st"> </span><span class="kw">sd</span>(sample_pop)  <span class="co">#Stikprøve standardafvigelse </span></a>
<a class="sourceLine" id="cb42-6" title="6">SE_sample &lt;-<span class="st"> </span>SD_sample<span class="op">/</span><span class="kw">sqrt</span>(n)  <span class="co">#Stikprøve standardfejl</span></a>
<a class="sourceLine" id="cb42-7" title="7"></a>
<a class="sourceLine" id="cb42-8" title="8">B &lt;-<span class="st"> </span><span class="dv">10000</span>  <span class="co"># Antal bootstrap-repetitioner</span></a>
<a class="sourceLine" id="cb42-9" title="9"></a>
<a class="sourceLine" id="cb42-10" title="10">meanFunc &lt;-<span class="st"> </span><span class="cf">function</span>(sample_pop, i) {</a>
<a class="sourceLine" id="cb42-11" title="11">    <span class="kw">mean</span>(sample_pop[i])</a>
<a class="sourceLine" id="cb42-12" title="12">}  <span class="co">#Estimator</span></a>
<a class="sourceLine" id="cb42-13" title="13"></a>
<a class="sourceLine" id="cb42-14" title="14">Boot_sample &lt;-<span class="st"> </span>boot<span class="op">::</span><span class="kw">boot</span>(<span class="dt">data =</span> sample_pop, <span class="dt">statistic =</span> meanFunc, <span class="dt">R =</span> B)  <span class="co">#Bootstrap-stikprøver</span></a>
<a class="sourceLine" id="cb42-15" title="15">SE_boot &lt;-<span class="st"> </span><span class="kw">sd</span>(Boot_sample<span class="op">$</span>t)  <span class="co">#Standardfejlen for bootstrap-stikprøver</span></a>
<a class="sourceLine" id="cb42-16" title="16"></a>
<a class="sourceLine" id="cb42-17" title="17">diff_procent &lt;-<span class="st"> </span>((<span class="kw">abs</span>(SE_sample <span class="op">-</span><span class="st"> </span>SE_boot))<span class="op">/</span>SE_sample) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>  <span class="co">#Procentvis afvigelse</span></a></code></pre></div>
<p>Fra eksemplet fås, at standardfejlen for bootstrap-stikprøven er <span class="math inline">\(se(\hat{\theta})=\)</span><code>0.032</code>, hvilket approksimerer stikprøvens standardfejl på <span class="math inline">\(\text{se}(\hat{\mu})=\)</span><code>0.032</code>, med en forskel i dette tilfælde på <code>0.881</code><span class="math inline">\(\%\)</span>. Hvis der opstår en situation hvor der ikke er en simpel måde hvorpå det er muligt at udregne standardfejlen, kan bootstrap altså udnyttes, da en forskel på <code>0.881</code><span class="math inline">\(\%\)</span> ikke er signifikant.</p>
<!--chapter:end:052-Boot_SE.Rmd-->
</div>
<div id="bootstrap-hypotesetest" class="section level2">
<h2><span class="header-section-number">4.3</span> Bootstrap-hypotesetest</h2>
<p>Som nævnt i afsnit @ref(t-test), skal visse antagelser være opfyldt, for at garantere korrektheden af resultaterne af en t-test, og det efterfølgende resultatet af overtrædelsen af disse antagelser, blev vist i afsnit @ref(t-test2).</p>
<!-- 1. Variablen er kvantitativ. -->
<!-- 2. Stikprøveudtagning er udført med tilfældighed. -->
<!-- 3. Populationen er normalfordelt. -->
<p>Når disse antagelser ikke er opfyldt, kan bootstrap anvendes til at udføre t-test, og i så fald kaldes det i det følgende for en bootstrap-test. I følgende to afsnit gennemgås først fremgangsmåden for en parret bootstrap-test, og dernæst fremgangsmåden for en uparret bootstrap-test.</p>
<div id="parret-bootstrap-test" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Parret bootstrap-test</h3>
<p>Lad to parrede stikprøver være givet, <span class="math inline">\(X=[x_{1},~x_{2},~...,~x_{n}]\)</span> og <span class="math inline">\(Y=[y_{1},~y_{2},~...,~y_{n}]\)</span>.
Der oprettes et tredje datasæt, <span class="math inline">\(Z\)</span>, som består af differencerne mellem <span class="math inline">\(x_i\)</span> og <span class="math inline">\(y_i\)</span>, <span class="math inline">\(Z = [x_1-y_1,~ x_2-y_2,~...,~x_n-y_n] = [z_1,~z_2,~...,~z_n]\)</span>. Ved hjælp af det nye datasæt er det muligt at udregne teststørrelsen, <span class="math inline">\(\bar{Z}\)</span>.</p>
<p>Så opstilles der en nulhypotese, <span class="math inline">\(H_0:~\mu = 0\)</span>, hvor <span class="math inline">\(\mu\)</span> angiver den sande middelværdi for <span class="math inline">\(Z\)</span>, og en alternativ hypotese, <span class="math inline">\(H_1:~\mu\neq 0\)</span>, samt et signifikansniveau, <span class="math inline">\(\alpha = 0.05\)</span>.</p>
<p>Der udtages en bootstrap-stikprøve for <span class="math inline">\(Z\)</span> af <span class="math inline">\(n\)</span> observationer med tilbagelægning, som betegnes <span class="math inline">\(Z^*\)</span>. På baggrund af bootstrap-stikprøven for <span class="math inline">\(Z\)</span>, kan der nu udregnes <span class="math inline">\(B\)</span> nye teststørrelser, <span class="math inline">\(t^*_i = \bar{Z^*_i}\)</span>, hvor <span class="math inline">\(Z^*_i = [z^*_{1,i},~z^*_{2,i},~...,~z^*_{n,i}]\)</span>, <span class="citation">(Laura M Chihara and Hesterberg <a href="#ref-BootvsJack" role="doc-biblioref">2019</a>, s. 106, 124-127)</span>.</p>
<p><em>P</em>-værdien ligger i intervallet <span class="math inline">\([0,1]\)</span>, <span class="math inline">\(p_{tosidet} \in [0,1]\)</span>, hvor <span class="math inline">\(p_{mindre} + p_{større} = 1\)</span> . Vælges <span class="math inline">\(\min (p_{mindre}, ~p_{større})\)</span> fås en ensidet <em>p</em>-værdien. For at opnå den tosidede <em>p</em>-værdi multipliceres der med <span class="math inline">\(2\)</span>. Se figur @ref(fig:fig-p-bootstrap) for illustration.</p>
<div class="figure">
<img src="P2-rapport_files/figure-html/fig-p-bootstrap-1.png" alt="(A) Fordelingen viser 40% observationer større end teststørrelsen og 60% observationer mindre. (B) Fordelingen viser 98% observationer større end teststørrelsen og 2% observationer mindre." width="672" />
<p class="caption">
(#fig:fig-p-bootstrap)(A) Fordelingen viser 40% observationer større end teststørrelsen og 60% observationer mindre. (B) Fordelingen viser 98% observationer større end teststørrelsen og 2% observationer mindre.
</p>
</div>
<p><span class="math inline">\(p_{mindre}\)</span> er lav i de tilfælde, hvor <span class="math inline">\(t^*\)</span> ofte er mindre end <span class="math inline">\(\bar Z\)</span>. Ligeledes gør det sig gældende, at <span class="math inline">\(p_{større}\)</span> er lav i de tilfælde, hvor <span class="math inline">\(t^*\)</span> ofte er større end <span class="math inline">\(\bar Z\)</span>. Funktionen <span class="math inline">\(\min\)</span> bliver benyttet eftersom der undersøges, hvor ofte mere ekstreme tilfælde optræder end den observerede teststørrelse, <span class="citation">(Geyer <a href="#ref-Hypo_test" role="doc-biblioref">n.d.</a>)</span>.</p>
<p><span class="math display">\[\begin{align}
p_{_{mindre}} &amp;= \frac{\text{antal gange }\{t^*&lt;\bar{Z}\}}{B} \\
p_{_{større}} &amp;= \frac{\text{antal gange }\{t^*&gt;\bar{Z}\}}{B} \\
p_{_{tosidet}} &amp;= 2 \cdot \text{min}(p_{_{mindre}},~p_{_{større}})
\end{align}\]</span></p>
<p>Forkast <span class="math inline">\(H_0\)</span>, hvis <span class="math inline">\(\text{p}_{_{tosidet}}&lt;\alpha\)</span>.</p>
<p><strong>Eksempel</strong></p>
<p>I nedenstående kode, vises et eksempel på en parret bootstrap-test.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="kw">set.seed</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb43-2" title="2">res &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">100</span>, {</a>
<a class="sourceLine" id="cb43-3" title="3">    </a>
<a class="sourceLine" id="cb43-4" title="4">    n &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb43-5" title="5">    stik1 &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n, <span class="dv">8</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb43-6" title="6">    stik2 &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n, <span class="dv">2</span>, <span class="dv">8</span>)</a>
<a class="sourceLine" id="cb43-7" title="7">    </a>
<a class="sourceLine" id="cb43-8" title="8">    t_obs &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(stik1 <span class="op">-</span><span class="st"> </span>stik2))</a>
<a class="sourceLine" id="cb43-9" title="9">    </a>
<a class="sourceLine" id="cb43-10" title="10">    B &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb43-11" title="11">    boot &lt;-<span class="st"> </span><span class="kw">replicate</span>(B, {</a>
<a class="sourceLine" id="cb43-12" title="12">        <span class="kw">sample</span>(<span class="dt">x =</span> <span class="kw">c</span>(stik1, stik2), <span class="dt">size =</span> <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb43-13" title="13">    })</a>
<a class="sourceLine" id="cb43-14" title="14">    </a>
<a class="sourceLine" id="cb43-15" title="15">    boot1 &lt;-<span class="st"> </span>boot[<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>, ]</a>
<a class="sourceLine" id="cb43-16" title="16">    boot2 &lt;-<span class="st"> </span>boot[<span class="dv">16</span><span class="op">:</span><span class="dv">30</span>, ]</a>
<a class="sourceLine" id="cb43-17" title="17">    </a>
<a class="sourceLine" id="cb43-18" title="18">    bootdiff &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> boot1, <span class="dt">nrow =</span> n, <span class="dt">ncol =</span> B<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb43-19" title="19">    bootmeans &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb43-20" title="20">    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B<span class="op">/</span><span class="dv">2</span>) {</a>
<a class="sourceLine" id="cb43-21" title="21">        bootdiff[<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>, i] &lt;-<span class="st"> </span><span class="kw">abs</span>(boot1[<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>, i] <span class="op">-</span><span class="st"> </span>boot2[<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>, i])</a>
<a class="sourceLine" id="cb43-22" title="22">        bootmeans[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(bootdiff[<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>, i])</a>
<a class="sourceLine" id="cb43-23" title="23">    }</a>
<a class="sourceLine" id="cb43-24" title="24">    </a>
<a class="sourceLine" id="cb43-25" title="25">    andel_mindre &lt;-<span class="st"> </span>bootmeans <span class="op">&lt;</span><span class="st"> </span>t_obs</a>
<a class="sourceLine" id="cb43-26" title="26">    </a>
<a class="sourceLine" id="cb43-27" title="27">    p_stoerre &lt;-<span class="st"> </span>(<span class="kw">sum</span>(andel_mindre))<span class="op">/</span><span class="kw">length</span>(andel_mindre)</a>
<a class="sourceLine" id="cb43-28" title="28">    p_mindre &lt;-<span class="st"> </span>(<span class="kw">length</span>(andel_mindre) <span class="op">-</span><span class="st"> </span>(<span class="kw">sum</span>(andel_mindre)))<span class="op">/</span><span class="kw">length</span>(andel_mindre)</a>
<a class="sourceLine" id="cb43-29" title="29">    </a>
<a class="sourceLine" id="cb43-30" title="30">    p_tosidet &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">min</span>(p_mindre, p_stoerre)</a>
<a class="sourceLine" id="cb43-31" title="31">})</a>
<a class="sourceLine" id="cb43-32" title="32"></a>
<a class="sourceLine" id="cb43-33" title="33">p_vaerdi_parret &lt;-<span class="st"> </span><span class="kw">mean</span>(res)</a>
<a class="sourceLine" id="cb43-34" title="34">p_vaerdi_parret</a></code></pre></div>
<pre><code>## [1] 0.00076</code></pre>
</div>
</div>
</div>
<div id="r-set.seed2-meanfunc---functionsample_popimeansample_popi-estimator-res---replicate100-n---100-stik1---rbetan-8-2-stik2---rbetan-2-8-t_obs---absstik1-stik2-t_obs_mean---meant_obs-b---1000-bootmeans---bootbootdata-t_obs-statistic-meanfunc-r-b-fori-in-1b-andel_mindre---bootmeanst0i-t_obs_mean-andel_mindre---bootmeanst0-t_obs_mean-p_stoerre---sumandel_mindre-b-p_mindre---b-sumandel_mindre-b-p_tosidet---2minp_mindre-p_stoerre-p_vaerdi_parret---meanres-p_vaerdi_parret" class="section level1">
<h1><span class="header-section-number">5</span> <code>{r} # set.seed(2) #  # meanFunc &lt;- function(sample_pop,i){mean(sample_pop[i])} #Estimator #  # res &lt;- replicate(100, { #    #   n &lt;- 100 #   stik1 &lt;- rbeta(n, 8, 2) #   stik2 &lt;- rbeta(n, 2, 8) #    #   t_obs &lt;- abs(stik1-stik2) #   t_obs_mean &lt;- mean(t_obs) #  #   B &lt;- 1000 #   bootmeans &lt;- boot::boot(data = t_obs, statistic = meanFunc, R = B) #   for(i in 1:B){ #     andel_mindre &lt;- bootmeans$t0[i] &lt; t_obs_mean #   } #    #   # andel_mindre &lt;- bootmeans$t0 &lt; t_obs_mean #   p_stoerre &lt;- (sum(andel_mindre)) / B #   p_mindre &lt;- (B-(sum(andel_mindre))) / B #  #   p_tosidet &lt;- 2*min(p_mindre, p_stoerre) # }) #  # p_vaerdi_parret &lt;- mean(res) # p_vaerdi_parret #</code></h1>
<p>Der ses altså at p-værdien er lig <code>8\times 10^{-4}</code>, hvilket er mindre end signifikansniveauet. Her vil nulhypotesen forkastes, da der er evidens for at differencen ikke er <span class="math inline">\(0\)</span>.</p>
<div id="uparret-bootstrap-test" class="section level3">
<h3><span class="header-section-number">5.0.1</span> Uparret bootstrap-test</h3>
<p>Lad to uafhængige uparrede stikprøver, <span class="math inline">\(X=[x_{1},~x_{2},~...,~x_{n}]\)</span> og <span class="math inline">\(Y=[y_{1},~y_{2},~...,~y_{m}]\)</span>, med ens varians, være givet.</p>
<p>På baggrund af forskellen i de to stikprøvers middelværdi, er det muligt at udregne en teststørrelse, <span class="math inline">\(\bar{X}-\bar{Y}\)</span>.</p>
<p>Så opstilles der en nulhypotese, <span class="math inline">\(H_0: \mu_{_X} = \mu_{_Y}\)</span>, hvor <span class="math inline">\(\mu_{_X}\)</span> og <span class="math inline">\(\mu_{_Y}\)</span> er de sande middelværdier for populationerne, hvorfra stikprøverne blev udtrukket og en alternativ hypotese, <span class="math inline">\(H_1: \mu_{_X} \neq \mu_{_Y}\)</span>, samt et signifikansniveau, <span class="math inline">\(\alpha = 0.05\)</span>.</p>
<p>Først forenes de to stikprøver til en samlet stikprøve med størrelsen <span class="math inline">\(n+m\)</span> observationer. Derefter laves en bootstrap-stikprøve af <span class="math inline">\(n+m\)</span> observationer med tilbagelægning fra den samlede stikprøve. Herefter udregnes middelværdien af de første <span class="math inline">\(n\)</span> observationer, som kaldes <span class="math inline">\(\hat{X}^*_1\)</span>. Desuden udregnes middelværdien af de resterende <span class="math inline">\(m\)</span> observationer, der kaldes <span class="math inline">\(\hat{Y}^*_1\)</span>. Til sidst udregnes bootstrap-teststørrelsen <span class="math inline">\(t^*_1=\hat{X}^*_1-\hat{Y}^*_1\)</span>, <span class="citation">(Myung <a href="#ref-BootHypo" role="doc-biblioref">2015</a>)</span>.</p>
<p>Trin to til fem i ovenstående gentages i alt <span class="math inline">\(B\)</span> gange, hvilket giver <span class="math inline">\(B\)</span> teststørrelser.</p>
<p>Herefter kan p-værdien udregnes, som antal gange bootstrap-teststørrelsen er mere ekstrem end den observerede teststørrelse. Dette gøres ved at finde den mindste af de to ensidede p-værdier og gange den med <span class="math inline">\(2\)</span>, <span class="citation">(Geyer <a href="#ref-Hypo_test" role="doc-biblioref">n.d.</a>)</span>.</p>
<p><span class="math display">\[\begin{align}
p_{_{mindre}} &amp;= \frac{\text{antal gange }\{t^*&lt;\bar{Z}\}}{B} \\
p_{_{større}} &amp;= \frac{\text{antal gange }\{t^*&gt;\bar{Z}\}}{B} \\
p_{_{tosidet}} &amp;= 2 \cdot \text{min}(p_{_{mindre}},~p_{_{større}})
\end{align}\]</span></p>
<p>Forkast <span class="math inline">\(H_0\)</span>, hvis <span class="math inline">\(\text{p}_{_{tosidet}}&lt;\alpha\)</span>.</p>
<p><strong>Eksempel</strong></p>
<p>Nu vil der vises et eksempel på en uparret bootstrap t-test.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">res &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">100</span>, {</a>
<a class="sourceLine" id="cb45-2" title="2">    n2 =<span class="st"> </span><span class="dv">15</span></a>
<a class="sourceLine" id="cb45-3" title="3">    m2 =<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb45-4" title="4">    stik3 &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n2, <span class="dv">8</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb45-5" title="5">    stik4 &lt;-<span class="st"> </span><span class="kw">rbeta</span>(m2, <span class="dv">2</span>, <span class="dv">8</span>)</a>
<a class="sourceLine" id="cb45-6" title="6">    </a>
<a class="sourceLine" id="cb45-7" title="7">    t_obs2 &lt;-<span class="st"> </span><span class="kw">mean</span>(stik3) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(stik4)</a>
<a class="sourceLine" id="cb45-8" title="8">    </a>
<a class="sourceLine" id="cb45-9" title="9">    B2 &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb45-10" title="10">    </a>
<a class="sourceLine" id="cb45-11" title="11">    res &lt;-<span class="st"> </span><span class="kw">replicate</span>(B2, {</a>
<a class="sourceLine" id="cb45-12" title="12">        </a>
<a class="sourceLine" id="cb45-13" title="13">        boot &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(stik3, stik4), <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb45-14" title="14">        </a>
<a class="sourceLine" id="cb45-15" title="15">        bootx &lt;-<span class="st"> </span>boot[<span class="dv">1</span><span class="op">:</span>n2]</a>
<a class="sourceLine" id="cb45-16" title="16">        booty &lt;-<span class="st"> </span>boot[(n2 <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(n2 <span class="op">+</span><span class="st"> </span>m2)]</a>
<a class="sourceLine" id="cb45-17" title="17">        </a>
<a class="sourceLine" id="cb45-18" title="18">        diffmean &lt;-<span class="st"> </span>(<span class="kw">mean</span>(bootx) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(booty))</a>
<a class="sourceLine" id="cb45-19" title="19">    })</a>
<a class="sourceLine" id="cb45-20" title="20">    </a>
<a class="sourceLine" id="cb45-21" title="21">    andel_mindre2 &lt;-<span class="st"> </span>res <span class="op">&lt;</span><span class="st"> </span>t_obs2</a>
<a class="sourceLine" id="cb45-22" title="22">    </a>
<a class="sourceLine" id="cb45-23" title="23">    p_stoerre2 &lt;-<span class="st"> </span>(<span class="kw">sum</span>(andel_mindre2))<span class="op">/</span><span class="kw">length</span>(andel_mindre2)</a>
<a class="sourceLine" id="cb45-24" title="24">    p_mindre2 &lt;-<span class="st"> </span>(<span class="kw">length</span>(andel_mindre2) <span class="op">-</span><span class="st"> </span>(<span class="kw">sum</span>(andel_mindre2)))<span class="op">/</span><span class="kw">length</span>(andel_mindre2)</a>
<a class="sourceLine" id="cb45-25" title="25">    </a>
<a class="sourceLine" id="cb45-26" title="26">    p_tosidet2 &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">min</span>(p_mindre2, p_stoerre2)</a>
<a class="sourceLine" id="cb45-27" title="27">})</a>
<a class="sourceLine" id="cb45-28" title="28"></a>
<a class="sourceLine" id="cb45-29" title="29">p_vaerdi_uparret &lt;-<span class="st"> </span><span class="kw">mean</span>(res)</a></code></pre></div>
<p>Der ses altså at p-værdien er lig <code>0</code>, hvilket er mindre end signifikansniveauet. Her vil nulhypotesen forkastes, da der er evidens for at differencen ikke er <span class="math inline">\(0\)</span>.</p>
<!--chapter:end:053-Boot_HYP.Rmd-->
</div>
<div id="bootstrap-konfidensintervaller" class="section level2">
<h2><span class="header-section-number">5.1</span> Bootstrap-konfidensintervaller</h2>
<p>I dette afsnit beskrives, hvorledes konfidensintervallet for en bootstrap-stikprøve beregnes ved hjælp af percentilmetoden, basic-metoden og T-metoden. Til sidst sammenlignes de tre metoders dækningsgrader ved forskellige stikprøvestørrelser.</p>
<p>Et <span class="math inline">\(95\%\)</span> konfidensinterval på en normalfordelt estimator, <span class="math inline">\(\Theta\)</span>, kan udregnes ved <span class="math inline">\(\text{KI} = [\hat\theta - 1.96\cdot \text{se}(\hat\theta),~\hat\theta + 1.96\cdot \text{se}(\hat\theta)]\)</span>, <span class="citation">(Orloff and Bloom <a href="#ref-BootKI" role="doc-biblioref">2014</a>)</span>. Hvis ikke fordelingen er kendt, er det ikke muligt at udregne et konfidensinterval således. Her er det i stedet muligt at benytte bootstrap til at udregne et konfidensinterval, hvilket kan gøres ved hjælp af forskellige metoder.</p>
<div id="percentilmetoden" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Percentilmetoden</h3>
<p>En intuitiv fremgangsmåde til at bestemme et <span class="math inline">\((1-\alpha)100\%\)</span> konfidensinterval ved percentiler, er at bruge det <span class="math inline">\((B(\frac{\alpha}{2}))\)</span>’te og <span class="math inline">\((B(1-\frac{\alpha}{2}))\)</span>’te percentil, hvor <span class="math inline">\(B\)</span> er antallet af bootstrap-repetitioner. Lad <span class="math inline">\(\Theta^* = [\vartheta_1,~ \ldots,~\vartheta_B]\)</span> være en sorteret liste af bootstrap-estimater. Derved er formlen for et konfidensinterval på baggrund af percentiler:</p>
<p><span class="math display">\[\text{KI}_p = \left[q_{(\alpha/2)},~q_{(1-\alpha/2)}\right]\]</span></p>
<p>Hvor <span class="math inline">\(q_i\)</span> er det <span class="math inline">\(i\)</span>’te percentil i <span class="math inline">\(\Theta^*\)</span>. <span class="citation">(Lau, Gonzalez, and Nolan <a href="#ref-TPKI" role="doc-biblioref">n.d.</a>)</span></p>
<p><strong>Eksempel</strong></p>
<p>I kodetstykket nedenfor udtages en tilfældig stikprøve fra en standard normalfordeling. Herefter laves <span class="math inline">\(10,000\)</span> bootstrap-stikprøver, som middelværdien udregnes på. Til sidst sorteres middelværdierne i en liste.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">data &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)  <span class="co"># Tilfældig stikprøve</span></a>
<a class="sourceLine" id="cb46-2" title="2"></a>
<a class="sourceLine" id="cb46-3" title="3">n &lt;-<span class="st"> </span><span class="kw">length</span>(data)</a>
<a class="sourceLine" id="cb46-4" title="4">B &lt;-<span class="st"> </span><span class="dv">10000</span>  <span class="co"># Bootstrap-repetitioner</span></a>
<a class="sourceLine" id="cb46-5" title="5"></a>
<a class="sourceLine" id="cb46-6" title="6">bootstrap_fordeling &lt;-<span class="st"> </span><span class="kw">replicate</span>(B, {</a>
<a class="sourceLine" id="cb46-7" title="7">    x &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sample</span>(data, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb46-8" title="8">})  <span class="co"># Bootstrap over middelværdien</span></a>
<a class="sourceLine" id="cb46-9" title="9"></a>
<a class="sourceLine" id="cb46-10" title="10">SortedData &lt;-<span class="st"> </span><span class="kw">sort</span>(bootstrap_fordeling)  <span class="co"># Bootstrap-fordelinger sorteret</span></a></code></pre></div>
<p>Dernæst vælges et konfidensniveau, som regel <span class="math inline">\(90\%\)</span>, <span class="math inline">\(95\%\)</span> eller <span class="math inline">\(99\%\)</span>.</p>
<p>Bootstrap-konfidensinterval ved hjælp af percentiler kan findes ved:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1">KI_niveau &lt;-<span class="st"> </span><span class="fl">0.95</span>  <span class="co"># Konfidensinterval</span></a>
<a class="sourceLine" id="cb47-2" title="2">alpha &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>KI_niveau  <span class="co"># Benyttes til percentilerne</span></a>
<a class="sourceLine" id="cb47-3" title="3"></a>
<a class="sourceLine" id="cb47-4" title="4">IndexLower &lt;-<span class="st"> </span><span class="kw">round</span>(B <span class="op">*</span><span class="st"> </span>alpha<span class="op">/</span><span class="dv">2</span>)  <span class="co"># Nedre percentil</span></a>
<a class="sourceLine" id="cb47-5" title="5">IndexUpper &lt;-<span class="st"> </span><span class="kw">round</span>(B <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha<span class="op">/</span><span class="dv">2</span>))  <span class="co"># Øvre percentil</span></a>
<a class="sourceLine" id="cb47-6" title="6"></a>
<a class="sourceLine" id="cb47-7" title="7">KI_Percentil &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">Lower =</span> SortedData[IndexLower], <span class="dt">Upper =</span> SortedData[IndexUpper])</a>
<a class="sourceLine" id="cb47-8" title="8"><span class="co"># Konfidensinterval vha. percentiler</span></a>
<a class="sourceLine" id="cb47-9" title="9"></a>
<a class="sourceLine" id="cb47-10" title="10">KI_Percentil</a></code></pre></div>
<pre><code>##      Lower      Upper 
## -0.1834957  0.1324827</code></pre>
</div>
<div id="basic-metoden" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Basic-metoden</h3>
<p>Denne type konfidensinterval ud fra bootstrap er også kendt som <em>reversed percentile interval</em>. Denne metode benytter formlen:</p>
<p><span class="math display">\[\text{KI}_b = \left[2\hat\theta- q_{(1-\alpha/2)}, ~ 2\hat\theta- q_{(\alpha/2)}\right]\]</span></p>
<p>Hvor <span class="math inline">\(q_i\)</span> er det <span class="math inline">\(i\)</span>’te percentil i <span class="math inline">\(\Theta^*\)</span> og <span class="math inline">\(\hat\theta\)</span> er middelværdien af stikprøven, <span class="citation">(Duke <a href="#ref-BasicKI" role="doc-biblioref">n.d.</a>)</span>.</p>
<p><strong>Eksempel</strong></p>
<p>I kodestykket nedenfor beregnes middelværdien af stikprøven og benyttes i formlen.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">theta_hat &lt;-<span class="st"> </span><span class="kw">mean</span>(data)</a>
<a class="sourceLine" id="cb49-2" title="2"></a>
<a class="sourceLine" id="cb49-3" title="3">KI_Basic &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">Lower =</span> <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>theta_hat <span class="op">-</span><span class="st"> </span>SortedData[IndexUpper], <span class="dt">Upper =</span> <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>theta_hat <span class="op">-</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-4" title="4"><span class="st">    </span>SortedData[IndexLower])</a>
<a class="sourceLine" id="cb49-5" title="5"></a>
<a class="sourceLine" id="cb49-6" title="6">KI_Basic</a></code></pre></div>
<pre><code>##      Lower      Upper 
## -0.1875641  0.1284143</code></pre>
</div>
<div id="t-metoden" class="section level3">
<h3><span class="header-section-number">5.1.3</span> T-metoden</h3>
<p>Konfidensintervaller kan også findes ved hjælp af standardfejl fra stikprøven, hvis stikprøven er tilnærmelsesvist t-fordelt.</p>
<p>Formlen for konfidensintervallet er:</p>
<p><span class="math display">\[\text{KI}_t=\left[\hat\theta-t^{*}_{(1-\alpha/2)}\cdot \hat{\text{se}}(\theta),~\hat\theta-t^{*}_{(\alpha/2)}\cdot\hat{\text{se}}(\theta)\right]\]</span></p>
<p>Hvor <span class="math inline">\(\hat\theta\)</span> er middelværdien af stikprøven, <span class="math inline">\(t^{*}=\frac{\hat{\vartheta}-\hat\theta}{\hat{\text{se}}(\vartheta)}\)</span> og <span class="math inline">\(\hat{\vartheta}\)</span> er middelværdien for <span class="math inline">\(\Theta^*\)</span>, <span class="citation">(Lau, Gonzalez, and Nolan <a href="#ref-TPKI" role="doc-biblioref">n.d.</a>)</span>.</p>
<p><strong>Eksempel</strong></p>
<p>I kodestykket forneden beregnes <span class="math inline">\(t^{*}\)</span> for det nedre og øvre percentil. Dernæst beregnes konfidensintervallet ud fra formlen.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1">tLower &lt;-<span class="st"> </span>(SortedData[IndexUpper] <span class="op">-</span><span class="st"> </span>theta_hat)<span class="op">/</span>(<span class="kw">sd</span>(bootstrap_fordeling))  <span class="co"># SD udregner standardfejl</span></a>
<a class="sourceLine" id="cb51-2" title="2">tUpper &lt;-<span class="st"> </span>(SortedData[IndexLower] <span class="op">-</span><span class="st"> </span>theta_hat)<span class="op">/</span>(<span class="kw">sd</span>(bootstrap_fordeling))  <span class="co"># SD udregner standardfejl</span></a>
<a class="sourceLine" id="cb51-3" title="3"></a>
<a class="sourceLine" id="cb51-4" title="4">KI_T &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">Lower =</span> theta_hat <span class="op">-</span><span class="st"> </span>tLower <span class="op">*</span><span class="st"> </span>(<span class="kw">sd</span>(data)<span class="op">/</span><span class="kw">sqrt</span>(n)), <span class="dt">Upper =</span> theta_hat <span class="op">-</span><span class="st"> </span>tUpper <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-5" title="5"><span class="st">    </span>(<span class="kw">sd</span>(data)<span class="op">/</span><span class="kw">sqrt</span>(n)))</a>
<a class="sourceLine" id="cb51-6" title="6">KI_T</a></code></pre></div>
<pre><code>##     Lower     Upper 
## -0.191583  0.132331</code></pre>
</div>
<div id="dækningsgrader" class="section level3">
<h3><span class="header-section-number">5.1.4</span> Dækningsgrader</h3>
<p>I dette afsnit vil der undersøges om metoderne for at udregne konfidensintervallerne med bootstrap er præcise. Dette gøres ved at udregne dækningsgraden af konfidensintervallerne som de forskellige metoder har produceret. Processen er den samme som i afsnit @ref(t-test2).</p>
<p>Som det første oprettes en funktion, der udregner middelværdien for stikprøven, og tager en stikprøve og et indeks som <em>input</em>.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1">meanFunc &lt;-<span class="st"> </span><span class="cf">function</span>(d, i) {</a>
<a class="sourceLine" id="cb53-2" title="2">    m &lt;-<span class="st"> </span><span class="kw">mean</span>(d<span class="op">$</span>data[i])</a>
<a class="sourceLine" id="cb53-3" title="3">    n &lt;-<span class="st"> </span><span class="kw">length</span>(i)</a>
<a class="sourceLine" id="cb53-4" title="4">    v &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(d<span class="op">$</span>data[i])<span class="op">/</span>n<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb53-5" title="5">    <span class="kw">c</span>(m, v)</a>
<a class="sourceLine" id="cb53-6" title="6">}</a>
<a class="sourceLine" id="cb53-7" title="7">sand_middel &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co">#Sand middelværdi</span></a></code></pre></div>
<p>Det næste der udregnes er et konfidensinterval. Konfidensintervallet beregnes ved hjælp af funktionen <code>boot.ci</code>, der kommer fra pakken <code>boot</code>. Der bliver først lavet 100 konfidensintervaller på baggrund af normalfordelte stikprøver. Så undersøges der om middelværdien af populationen er i konfidensintervallet. Hvis det er tilfældet, vil outputtet være <code>TRUE</code>, hvis ikke vil det være <code>FALSE</code>. Herefter indsættes disse output i en matrix. Til sidst beregnes dækningsgraden som andelen af de intervaller, der indeholder den sande middelværdi. Der laves 100 konfidensintervaller for hver stikprøvestørrelse. Stikprøvestørrelsen er angivet i en sekvens fra 4 til 100 med spring på 4. Denne proces udføres for de tre konfidensintervalmetoder, percentil, T og basic.</p>
<p>Her udføres processen for beregning af dækningsgraden for alle tre metoder.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">matriks_p &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">ncol =</span> <span class="dv">25</span>, <span class="dt">nrow =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb54-2" title="2">vector_p &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb54-3" title="3">matriks_b &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">ncol =</span> <span class="dv">25</span>, <span class="dt">nrow =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb54-4" title="4">vector_b &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb54-5" title="5">matriks_t &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">ncol =</span> <span class="dv">25</span>, <span class="dt">nrow =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb54-6" title="6">vector_t &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb54-7" title="7"></a>
<a class="sourceLine" id="cb54-8" title="8"><span class="cf">for</span> (n <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">4</span>, <span class="dv">100</span>, <span class="dv">4</span>)) {</a>
<a class="sourceLine" id="cb54-9" title="9">    res &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">100</span>, {</a>
<a class="sourceLine" id="cb54-10" title="10">        stik &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">data =</span> <span class="kw">rnorm</span>(n))</a>
<a class="sourceLine" id="cb54-11" title="11">        boot_stik &lt;-<span class="st"> </span><span class="kw">boot</span>(stik, <span class="dt">statistic =</span> meanFunc, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb54-12" title="12">        interval &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(boot_stik, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;perc&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;stud&quot;</span>))</a>
<a class="sourceLine" id="cb54-13" title="13">        interval_p &lt;-<span class="st"> </span>interval<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb54-14" title="14">        interval_b &lt;-<span class="st"> </span>interval<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb54-15" title="15">        interval_t &lt;-<span class="st"> </span>interval<span class="op">$</span>student[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb54-16" title="16">        </a>
<a class="sourceLine" id="cb54-17" title="17">        tf_p &lt;-<span class="st"> </span>interval_p[<span class="dv">1</span>] <span class="op">&lt;=</span><span class="st"> </span>sand_middel <span class="op">&amp;</span><span class="st"> </span>interval_p[<span class="dv">2</span>] <span class="op">&gt;=</span><span class="st"> </span>sand_middel</a>
<a class="sourceLine" id="cb54-18" title="18">        tf_b &lt;-<span class="st"> </span>interval_b[<span class="dv">1</span>] <span class="op">&lt;=</span><span class="st"> </span>sand_middel <span class="op">&amp;</span><span class="st"> </span>interval_b[<span class="dv">2</span>] <span class="op">&gt;=</span><span class="st"> </span>sand_middel</a>
<a class="sourceLine" id="cb54-19" title="19">        tf_t &lt;-<span class="st"> </span>interval_t[<span class="dv">1</span>] <span class="op">&lt;=</span><span class="st"> </span>sand_middel <span class="op">&amp;</span><span class="st"> </span>interval_t[<span class="dv">2</span>] <span class="op">&gt;=</span><span class="st"> </span>sand_middel</a>
<a class="sourceLine" id="cb54-20" title="20">        <span class="kw">return</span>(<span class="kw">c</span>(tf_p, tf_b, tf_t))</a>
<a class="sourceLine" id="cb54-21" title="21">    })</a>
<a class="sourceLine" id="cb54-22" title="22">    </a>
<a class="sourceLine" id="cb54-23" title="23">    matriks_p[, n<span class="op">/</span><span class="dv">4</span>] &lt;-<span class="st"> </span>res[<span class="dv">1</span>, ]</a>
<a class="sourceLine" id="cb54-24" title="24">    vector_p &lt;-<span class="st"> </span><span class="kw">append</span>(vector_p, <span class="kw">mean</span>(matriks_p[, n<span class="op">/</span><span class="dv">4</span>]))</a>
<a class="sourceLine" id="cb54-25" title="25">    </a>
<a class="sourceLine" id="cb54-26" title="26">    matriks_b[, n<span class="op">/</span><span class="dv">4</span>] &lt;-<span class="st"> </span>res[<span class="dv">2</span>, ]</a>
<a class="sourceLine" id="cb54-27" title="27">    vector_b &lt;-<span class="st"> </span><span class="kw">append</span>(vector_b, <span class="kw">mean</span>(matriks_b[, n<span class="op">/</span><span class="dv">4</span>]))</a>
<a class="sourceLine" id="cb54-28" title="28">    </a>
<a class="sourceLine" id="cb54-29" title="29">    matriks_t[, n<span class="op">/</span><span class="dv">4</span>] &lt;-<span class="st"> </span>res[<span class="dv">3</span>, ]</a>
<a class="sourceLine" id="cb54-30" title="30">    vector_t &lt;-<span class="st"> </span><span class="kw">append</span>(vector_t, <span class="kw">mean</span>(matriks_t[, n<span class="op">/</span><span class="dv">4</span>]))</a>
<a class="sourceLine" id="cb54-31" title="31">}</a>
<a class="sourceLine" id="cb54-32" title="32">vector_p</a></code></pre></div>
<pre><code>##  [1] 0.82 0.89 0.95 0.87 0.89 0.94 0.93 0.96 0.91 0.98 0.95 0.96 0.93 0.95 0.97
## [16] 0.95 0.93 0.94 0.97 0.94 0.92 0.94 0.96 0.94 0.93</code></pre>
<p>I <em>vector_p</em> ses middelværdierne for dækningsgraden af 100 konfidensintervaller genereret ud fra percentilmetoden. Den første middelværdi er for stikprøvestørrelsen <span class="math inline">\(n = 4\)</span>, den næste er for stikprøvestørrelsen <span class="math inline">\(n = 8\)</span> osv.</p>
Dækningsgraderne for de tre metoder illustreres på figur @ref(fig:fig-daekning).
<div class="figure" style="text-align: center">
<img src="P2-rapport_files/figure-html/fig-daekning-1.png" alt="Dækningsgraden for de tre konfidensintervaller udarbejdet ved hjælp af bootstraps. På x-aksen ses stikprøve størrelsen, mens på y-aksen ses dækningsgraden af konfidensintervallet på baggrund af den givne stikprøve størrelse. 0.95 er det ønsket konfidenslevel." width="672" />
<p class="caption">
(#fig:fig-daekning)Dækningsgraden for de tre konfidensintervaller udarbejdet ved hjælp af bootstraps. På x-aksen ses stikprøve størrelsen, mens på y-aksen ses dækningsgraden af konfidensintervallet på baggrund af den givne stikprøve størrelse. 0.95 er det ønsket konfidenslevel.
</p>
</div>
<p>Her tyder det på, at T-metoden præsterer bedre ved mindre stikprøver end både percentilmetoden og basic-metoden. Omkring <span class="math inline">\(n=15\)</span> opnår percentil- og basic-metodens konfidensinterval begge den samme dækningsgrad som T-metoden, og generelt kan der ses, at percentil- og basic-metoden har cirka den samme dækningsgrad. Både percentil- og basic-metoden ser ud til at have større udsvingninger end T-metoden. Desuden ser alle tre metoders dækningsgrader ud til at stabilisere sig omkring <span class="math inline">\(95\%\)</span>, når stikprøvestørrelsen bliver tilstrækkelig stor.</p>
<!--chapter:end:054-Boot_KI.Rmd-->
</div>
</div>
</div>
<div id="diskussion" class="section level1">
<h1><span class="header-section-number">6</span> Diskussion</h1>
<p>Diskutér</p>
<!--chapter:end:96-Diskussion.Rmd-->
</div>
<div id="konklusion" class="section level1">
<h1><span class="header-section-number">7</span> Konklusion</h1>
<p>Konkludér</p>
<!--chapter:end:97-Konklusion.Rmd-->
</div>
<div id="perspektivering" class="section level1">
<h1><span class="header-section-number">8</span> Perspektivering</h1>
<p>Perspektivér!</p>
<ol style="list-style-type: decimal">
<li><strong>T-testens robusthed</strong></li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>For pæne resultater</li>
</ol>
<ol start="2" style="list-style-type: decimal">
<li><strong>Faldgruber</strong></li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Antagelser ikke opfyldt</li>
</ol>
<ol start="3" style="list-style-type: decimal">
<li><strong>Relevans af simulering</strong></li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Simulering af reel data</li>
</ol>
<ol start="4" style="list-style-type: decimal">
<li><strong>Permutationstest til hypotesetest</strong></li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Sammenligning med bootstrap</li>
<li>Alternativ til boostrap</li>
</ol>
<ol start="5" style="list-style-type: decimal">
<li><strong>Permutationstest til konfidensintervaller</strong></li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Er det muligt?</li>
</ol>
<ol start="6" style="list-style-type: decimal">
<li><strong>Type-I og type-II fejl</strong></li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Undersøg om de er i dataen</li>
</ol>
<ol start="7" style="list-style-type: decimal">
<li><strong>Bootstraps begrænsinger</strong></li>
<li><strong>Bedre computerkraft</strong></li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Vil det forbedre resultaterne?</li>
</ol>
<ol start="9" style="list-style-type: decimal">
<li><strong>Parametrisk bootstrap</strong></li>
</ol>
<p>Done.</p>
<!--chapter:end:98-Perspektivering.Rmd-->
</div>
<div id="bibliografi" class="section level1 unnumbered">
<h1>Bibliografi</h1>
<!--chapter:end:99-Bibliografi.Rmd-->
<div id="refs" class="references">
<div id="ref-ASTAkursus1">
<p>AAU, The Applied Statistics Team. 2020a. “ASTA - Lektion 1.1.” 2020. <a href="https://asta.math.aau.dk/course/asta/2020-1/std/lecture/1-1">https://asta.math.aau.dk/course/asta/2020-1/std/lecture/1-1</a>.</p>
</div>
<div id="ref-ASTAkursus2">
<p>———. 2020b. “ASTA - Lektion 1.2.” 2020. <a href="https://asta.math.aau.dk/course/asta/2020-1/std/lecture/1-2">https://asta.math.aau.dk/course/asta/2020-1/std/lecture/1-2</a>.</p>
</div>
<div id="ref-ASTAkursus3">
<p>———. 2020c. “ASTA - Lektion 1.3.” 2020. <a href="https://asta.math.aau.dk/course/asta/2020-1/std/lecture/1-3">https://asta.math.aau.dk/course/asta/2020-1/std/lecture/1-3</a>.</p>
</div>
<div id="ref-ASTAkursus4">
<p>———. 2020d. “ASTA - Lektion 2.1 Hypothesis Test.” 2020. <a href="https://asta.math.aau.dk/course/asta/2020-1/std/lecture/2-1?file=B/lecture-B-1.html#(1)">https://asta.math.aau.dk/course/asta/2020-1/std/lecture/2-1?file=B/lecture-B-1.html#(1)</a>.</p>
</div>
<div id="ref-ASTAbog">
<p>Agresti, Alan, and Barbara Finlay. 2014. <em>Statistical Methods for the Social Sciences</em>. 4th ed. Edinburgh Gate, England: Pearson.</p>
</div>
<div id="ref-BootMiracle">
<p>Bartlett, Jonathan. 2013. “The Miracle of the Bootstrap.” 2013. <a href="https://thestatsgeek.com/2013/07/02/the-miracle-of-the-bootstrap/">https://thestatsgeek.com/2013/07/02/the-miracle-of-the-bootstrap/</a>.</p>
</div>
<div id="ref-nonparaboot">
<p>Berrar, Daniel. 2019. “Introduction to the Non-Parametric Bootstrap.” 2019. <a href="https://www.researchgate.net/publication/332553015_Introduction_to_the_Non-Parametric_Bootstrap">https://www.researchgate.net/publication/332553015_Introduction_to_the_Non-Parametric_Bootstrap</a>.</p>
</div>
<div id="ref-BootvsJack">
<p>Chihara, Laura M, and Tim C. Hesterberg. 2019. <em>Mathematical Statistics with Resampling and R</em>. 2nd ed. Hoboken, NJ: John Wiley; Sons, Inc.</p>
</div>
<div id="ref-MathStat">
<p>Chihara, Laura M., and Tim C. Hesterberg. 2019. <em>Mathematical Statistics with Resampling and R</em>. 2nd ed. 111 River Street, Hoboken, NJ 07030, USA: John Wiley &amp; Sons, Inc.</p>
</div>
<div id="ref-lincongenvis">
<p>Cmglee. 2015. “Linear Congruential Generator Visualisation.” 2015. <a href="https://commons.wikimedia.org/w/index.php?curid=38637545">https://commons.wikimedia.org/w/index.php?curid=38637545</a>.</p>
</div>
<div id="ref-Orddef">
<p>Dictionary, Online Etymology. 2020. “Statistics.” 2020. <a href="https://www.etymonline.com/word/statistics?fbclid=IwAR24xfhlEU8QlZQWFlc8zdzbupnl-HDFTIdr8y4HwH637e5yP1XO9Lh3dqs">https://www.etymonline.com/word/statistics?fbclid=IwAR24xfhlEU8QlZQWFlc8zdzbupnl-HDFTIdr8y4HwH637e5yP1XO9Lh3dqs</a>.</p>
</div>
<div id="ref-CambridgeSimulation">
<p>Dictonary, Cambridge. 2020. “Simulation.” 2020. <a href="https://dictionary.cambridge.org/dictionary/english/simulation">https://dictionary.cambridge.org/dictionary/english/simulation</a>.</p>
</div>
<div id="ref-BasicKI">
<p>Duke, Stat. n.d. “Bootstrap Confidence Intervals.” Accessed April 6, 2020. <a href="http://www2.stat.duke.edu/~banks/111-lectures.dir/lect13.pdf">http://www2.stat.duke.edu/~banks/111-lectures.dir/lect13.pdf</a>.</p>
</div>
<div id="ref-HvorforHYPO">
<p>Editor, Minitab Blog. 2015. “Understanding Hypothesis Tests: Why We Need to Use Hypothesis Tests in Statistics.” 2015. <a href="https://blog.minitab.com/blog/adventures-in-statistics-2/understanding-hypothesis-tests-why-we-need-to-use-hypothesis-tests-in-statistics">https://blog.minitab.com/blog/adventures-in-statistics-2/understanding-hypothesis-tests-why-we-need-to-use-hypothesis-tests-in-statistics</a>.</p>
</div>
<div id="ref-RonaldFisher">
<p>Encyclopaedia Britannica, The Editors of. 2020. “Sir Ronald Aylmer Fisher.” 2020. <a href="https://www.britannica.com/biography/Ronald-Aylmer-Fisher">https://www.britannica.com/biography/Ronald-Aylmer-Fisher</a>.</p>
</div>
<div id="ref-MercedesF1">
<p>F1, Mercedes AMG. 2020. “Simulator.” 2020. <a href="https://careers.mercedesamgf1.com/facilities/simulator/">https://careers.mercedesamgf1.com/facilities/simulator/</a>.</p>
</div>
<div id="ref-Fejltyper">
<p>Frydenberg, Morten. 2001. “Epidemiologi Og Biostatistik.” 2001. <a href="https://www.biostat.au.dk/teaching/praegrad/for%C3%A5r2001/forelaesninger/biostatistik/uge2torsdag.pdf">https://www.biostat.au.dk/teaching/praegrad/for%C3%A5r2001/forelaesninger/biostatistik/uge2torsdag.pdf</a>.</p>
</div>
<div id="ref-Hypo_test">
<p>Geyer, Charlie. n.d. “Bootstrap Hypothesis Tests.” Accessed April 15, 2020. <a href="http://www.stat.umn.edu/geyer/old/5601/examp/tests.html">http://www.stat.umn.edu/geyer/old/5601/examp/tests.html</a>.</p>
</div>
<div id="ref-Permutationstest">
<p>Giles, Dave. 2019. “What Is a Permutation Test?” 2019. <a href="https://www.r-bloggers.com/what-is-a-permutation-test/0/">https://www.r-bloggers.com/what-is-a-permutation-test/0/</a>.</p>
</div>
<div id="ref-PRNGintro">
<p>Herzog, Thomas N., and Graham Lord. 2002. “Applications of Monte Carlo Methods to Finance and Insurance.” 2002. <a href="https://books.google.co.th/books?id=ibpfxsxuCUAC&amp;pg=PA12&amp;dq=middel+square+method&amp;hl=da&amp;sa=X&amp;ved=0ahUKEwjZ9Mn3i4voAhX-zDgGHd9RBlcQ6AEINjAB#v=onepage&amp;q&amp;f=false">https://books.google.co.th/books?id=ibpfxsxuCUAC&amp;pg=PA12&amp;dq=middel+square+method&amp;hl=da&amp;sa=X&amp;ved=0ahUKEwjZ9Mn3i4voAhX-zDgGHd9RBlcQ6AEINjAB#v=onepage&amp;q&amp;f=false</a>.</p>
</div>
<div id="ref-Gammadist">
<p>Kim, Aerin. 2019. “Gamma Distribution — Intuition, Derivation, and Examples.” 2019. <a href="https://commons.wikimedia.org/w/index.php?curid=38637545">https://commons.wikimedia.org/w/index.php?curid=38637545</a>.</p>
</div>
<div id="ref-TDSBeta">
<p>———. 2020. “Beta Distribution — Intuition, Examples, and Derivation.” 2020. <a href="https://towardsdatascience.com/beta-distribution-intuition-examples-and-derivation-cf00f4db57af">https://towardsdatascience.com/beta-distribution-intuition-examples-and-derivation-cf00f4db57af</a>.</p>
</div>
<div id="ref-TPKI">
<p>Lau, Sam, Joey Gonzalez, and Deb Nolan. n.d. “Principles and Techniques of Data Science.” Accessed April 6, 2020. <a href="https://www.textbook.ds100.org/ch/18/hyp_studentized.html">https://www.textbook.ds100.org/ch/18/hyp_studentized.html</a>.</p>
</div>
<div id="ref-BootYouTube1">
<p>Marin, Mike. 2018. “Bootstrapping and Resampling in Statistics with Example| Statistics Tutorial # 12 |MarinStatsLectures.” 2018. <a href="https://www.youtube.com/watch?v=O_Fj4q8lgmc&amp;list=PLqzoL9-eJTNDp_bWyWBdw2ioA43B3dBrl&amp;index=2&amp;t=1s">https://www.youtube.com/watch?v=O_Fj4q8lgmc&amp;list=PLqzoL9-eJTNDp_bWyWBdw2ioA43B3dBrl&amp;index=2&amp;t=1s</a>.</p>
</div>
<div id="ref-Chiianden">
<p>Matematikcenter. 2020. “Chi I Anden-Test.” 2020. <a href="https://www.webmatematik.dk/lektioner/matematik-b/statistik/chi-i-anden-test">https://www.webmatematik.dk/lektioner/matematik-b/statistik/chi-i-anden-test</a>.</p>
</div>
<div id="ref-BootHypo">
<p>Myung, Jay. 2015. “Bootstrap Hypothesis Testing.” 2015. <a href="https://faculty.psy.ohio-state.edu/myung/personal/course/826/bootstrap_hypo.pdf">https://faculty.psy.ohio-state.edu/myung/personal/course/826/bootstrap_hypo.pdf</a>.</p>
</div>
<div id="ref-BootKI">
<p>Orloff, Jeremy, and Jonathan Bloom. 2014. “Bootstrap Confidence Intervals.” 2014. <a href="https://ocw.mit.edu/courses/mathematics/18-05-introduction-to-probability-and-statistics-spring-2014/readings/MIT18_05S14_Reading24.pdf">https://ocw.mit.edu/courses/mathematics/18-05-introduction-to-probability-and-statistics-spring-2014/readings/MIT18_05S14_Reading24.pdf</a>.</p>
</div>
<div id="ref-PRGNfunc">
<p>Oxford, The Numerical Algorithms Group Ltd. 2015. “NAG Toolbox Chapter Introduction — Random Number Generators.” 2015. <a href="https://www.nag.co.uk/numeric/mb/nagdoc_mb/manual_25_1/html/g05/g05intro.html">https://www.nag.co.uk/numeric/mb/nagdoc_mb/manual_25_1/html/g05/g05intro.html</a>.</p>
</div>
<div id="ref-Rsimulation">
<p>Peng, Roger D. 2019. “R Programming for Data Science.” 2019. <a href="https://bookdown.org/rdpeng/rprogdatascience/simulation.html">https://bookdown.org/rdpeng/rprogdatascience/simulation.html</a>.</p>
</div>
<div id="ref-KarlPearsonbrit">
<p>Porter, Theodore M. 2020. “Karl Pearson.” 2020. <a href="https://www.britannica.com/biography/Karl-Pearson">https://www.britannica.com/biography/Karl-Pearson</a>.</p>
</div>
<div id="ref-LCGinfo">
<p>Radziwill, Nicole. 2015. “A Linear Congruential Generator (Lcg) in R.” 2015. <a href="https://qualityandinnovation.com/2015/03/03/a-linear-congruential-generator-lcg-in-r/#comments">https://qualityandinnovation.com/2015/03/03/a-linear-congruential-generator-lcg-in-r/#comments</a>.</p>
</div>
<div id="ref-ASTA-HYPO">
<p>Team, ASTA. 2020. “Hypothesis Test.” 2020. <a href="https://asta.math.aau.dk/course/asta/2020-1/std/lecture/2-1?file=B/lecture-B-1.pdf">https://asta.math.aau.dk/course/asta/2020-1/std/lecture/2-1?file=B/lecture-B-1.pdf</a>.</p>
</div>
<div id="ref-LCGsimu">
<p>Trumbo, Bruce E. 2005. “Congruential Generators of Pseudorandom Numbers.” 2005. <a href="http://www.sci.csueastbay.edu/~btrumbo/Stat3401/Hand3401/CongGenIntroB.pdf">http://www.sci.csueastbay.edu/~btrumbo/Stat3401/Hand3401/CongGenIntroB.pdf</a>.</p>
</div>
<div id="ref-Box-Muller">
<p>Weisstein, Eric W. 2020a. “Box-Muller Transformation.” 2020. <a href="https://mathworld.wolfram.com/Box-MullerTransformation.html">https://mathworld.wolfram.com/Box-MullerTransformation.html</a>.</p>
</div>
<div id="ref-Permutationer">
<p>———. 2020b. “Permutation.” 2020. <a href="https://mathworld.wolfram.com/Permutation.html">https://mathworld.wolfram.com/Permutation.html</a>.</p>
</div>
<div id="ref-SAS">
<p>Wicklin, Rick. 2017. “The Average Bootstrap Sample Omits 36.8.” 2017. <a href="https://blogs.sas.com/content/iml/2017/06/28/average-bootstrap-sample-omits-data.html">https://blogs.sas.com/content/iml/2017/06/28/average-bootstrap-sample-omits-data.html</a>.</p>
</div>
<div id="ref-TDSBootstrap">
<p>Yen, Lorna. 2019. “An Introduction to the Bootstrap Method.” 2019. <a href="https://towardsdatascience.com/an-introduction-to-the-bootstrap-method-58bcb51b4d60">https://towardsdatascience.com/an-introduction-to-the-bootstrap-method-58bcb51b4d60</a>.</p>
</div>
</div>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
