```{r}
n <- 100
stik <- rnorm(n, 0, 1)
x_bar <- mean(stik)
x_sd <- sd(stik)
n_boot <- 1000
x <- rnorm(n*n_boot, x_bar, x_sd)
bootstrapsample <- matrix(x, nrow = n, ncol = n_boot)
x_star <- colMeans(bootstrapsample)
delta_star <- x_star - x_bar
d <- quantile(delta_star, c(0.05, 0.95))
ci <- x_bar - c(d[2], d[1])
ci
```

```{r}
set.seed(1)
sand_middel <- 0
n_boot <- 100
matriks_p <- matrix(ncol = 25, nrow = 100)
vector_p <- c()

for (n in seq(4, 16, 4)){
  stik <- rnorm(n)
  stikmean <- mean(stik)
  sdstik <- sd(stik)
  
  res <- replicate(100, {
    bootliste <- rnorm(n*n_boot, stikmean, sdstik)
    bootsamples <- matrix(bootliste, nrow = n, ncol = n_boot)
    bootmean <- colMeans(bootsamples)
    estimater <- stikmean - bootmean
    kvartiler <- quantile(estimater, c(0.05, 0.95))
    konfinf <- stikmean - c(kvartiler[2], kvartiler[1])
    
    tf <- konfinf[1]<=sand_middel & konfinf[2]>=sand_middel
    return(tf)
  })
  
  matriks_p[,n/4] <- unname(res)
  vector_p <- append(vector_p, mean(matriks_p[,n/4]))
}

tf
#vector_p
```



```{r}
set.seed(31415)
sand_middel <- 0

tabel <- c()

for(n in seq(4, 16, 4)){
  stik <- rnorm(n)
  x_bar <- mean(stik)
  x_sd <- sd(stik)
  n_boot <- 1000
  res <- replicate(n = 4,{
    bootliste <- rnorm(n*n_boot, x_bar, x_sd)
    bootstrapsample <- matrix(bootliste, nrow = n, ncol = n_boot)
    x_star <- colMeans(bootstrapsample)
    delta_star <- x_star - x_bar
    d <- quantile(delta_star, c(0.05, 0.95))
    ci <- x_bar - c(d[2], d[1])
    #print(ci)
    # UndersÃ¸ger om den sande middelvÃ¦rdi er i konfidensintervallet
    tf_p <- ci[1]<=0 & ci[2]>=0
    print(tf_p)
    return(unname(tf_p))
  })
  print(table(res))
  #tabel <- append(tabel, table(res))
}
#tabel
```

