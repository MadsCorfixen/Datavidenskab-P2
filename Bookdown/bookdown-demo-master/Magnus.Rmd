```{r}
set.seed(2)
pop_middel = 10

vector_p <- c()
vector_b <- c()
vector_t <- c()

for(n in seq(4, 20, 4)){
  
  stik <- rnorm(n, pop_middel, 1)
  middel_stik <- mean(stik)
  sd_stik <- sd(stik)
  
  r = 5
  res <- replicate(r, {
    simSamples <- replicate(r, rnorm(n, middel_stik, sd_stik))

    simMeans <- apply(simSamples, 2, mean)
  
    konf_p <- quantile(simMeans, c(0.025, 0.975))
    konf_b <- 2 * middel_stik - quantile(simMeans, c(0.975, 0.025))
    konf_t <- middel_stik - ((quantile(simMeans, c(0.975, 0.025)) - middel_stik)/sd(simSamples)) *    
    sd_stik
    
    tf_p <- konf_p[1] <= pop_middel & konf_p[2] >= pop_middel
    tf_b <- konf_b[1] <= pop_middel & konf_b[2] >= pop_middel
    tf_t <- konf_t[1] <= pop_middel & konf_t[2] >= pop_middel
    
    return(c(tf_p, tf_b, tf_t))
  })
  
  print(res)
  print(sum(res[1,]))
  print(sum(res[1,])/r)
  
  vector_p <- append(vector_p, sum(res[1,])/r)
  vector_b <- append(vector_b, sum(res[2,])/r)
  vector_t <- append(vector_t, sum(res[3,])/r)
}

print(vector_p)
```


```{r}
x <- seq(4, 20, 4)
plot(x, vector_p, type="l", col="red", ylab = "Dækningsgrad",
      xlab = "Stikprøvestørrelse", ylim = c(0, 1))
lines(x, vector_b, type="l", col="blue")
lines(x, vector_t, type="l", col="green")
abline(h=0.95, lty=5, col="black")
```


