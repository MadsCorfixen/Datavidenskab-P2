# Funktioner til Bootstrap-KI
## Funktion til bootstrap-kofidensinterval vha. percentilmetoden
```{r}
bootstrap_ki_perc_metode <- function(data, bootstrap_iterationer = 10000,
                              konfidensniveau = 0.95){
  n <- length(data)
  B <- bootstrap_iterationer
  
  bootstrap_stik <- replicate(B, {
    middel_boot <- mean(sample(data, size = n, replace = TRUE))
  })
  
  sorted_boot <- sort(bootstrap_stik)
  alpha <- 1-konfidensniveau
  index_nedre <- round(B * alpha/2)
  index_ovre <- round(B * (1-alpha/2))
  
  ki_percentil <- c(nedre = sorted_boot[index_nedre],
                    oevre = sorted_boot[index_ovre])
  
  return(ki_percentil)
}
```

## Funktion til bootstrap-kofidensinterval vha. basic-metoden
```{r}
bootstrap_ki_basic_metode <- function(data, bootstrap_iterationer = 10000,
                               konfidensniveau = 0.95){
  n <- length(data)
  B <- bootstrap_iterationer
  middel_data <- mean(data)
  
  bootstrap_stik <- replicate(B, {
    middel_boot <- mean(sample(data, size = n, replace = TRUE))
  })
  
  sorteret_boot <- sort(bootstrap_stik)
  alpha <- 1-konfidensniveau
  index_nedre <- round(B * alpha/2)
  index_ovre <- round(B * (1-alpha/2))
  
  ki_basic <- c(nedre = 2*middel_data-sorteret_boot[index_ovre],
                oevre = 2*middel_data-sorteret_boot[index_nedre])
  
  return(ki_basic)
}
```


## Funktion til bootstrap-konfidensinterval vha. t-metoden
```{r}
bootstrap_ki_t_metode <- function(data, bootstrap_iterationer = 10000,
                               konfidensniveau = 0.95){
  n <- length(data)
  B <- bootstrap_iterationer
  middel_data <- mean(data)
  
  bootstrap_stik <- replicate(B, {
    middel_boot <- mean(sample(data, size = n, replace = TRUE))
  })
  
  sorteret_boot <- sort(bootstrap_stik)
  alpha <- 1-konfidensniveau
  index_nedre <- round(B * alpha/2)
  index_ovre <- round(B * (1-alpha/2))
  
  t_nedre <- (sorteret_boot[index_ovre]-middel_data) /
  (sd(bootstrap_stik))
  t_ovre <- (sorteret_boot[index_nedre]-middel_data) /
  (sd(bootstrap_stik))
  
  ki_t <- c(nedre = middel_data - t_nedre * (sd(data)/sqrt(n)),
            oevre = middel_data - t_ovre * (sd(data)/sqrt(n)))
  
  return(ki_t)
}
```



# Test af dÃ¦kningsgrad
```{r}
population <- rbeta(100000, 2, 8)
test_perc <- c()
test_basic <- c()
test_t <- c()

daekningsgrad <- replicate(100,{
  perc_ki <- bootstrap_ki_perc_metode(data = sample(population, 100),
                         bootstrap_iterationer = 1000)

  basic_ki <- bootstrap_ki_basic_metode(data = sample(population, 100),
                          bootstrap_iterationer = 1000)

  t_ki <- bootstrap_ki_t_metode(data = sample(population, 100),
                      bootstrap_iterationer = 1000)
  
  stik <- sample(population, 100)
  stik_mean <- mean(stik)
  
  if(stik_mean >= perc_ki[1] & stik_mean<= perc_ki[2]){
    test_perc <- append(test_perc, 1)
  }else{
    test_perc <- append(test_perc, 0)
  }
  
  if(stik_mean >= basic_ki[1] & stik_mean <= basic_ki[2]){
    test_basic <- append(test_basic, 1)
  }else{
    test_basic <- append(test_basic, 0)
  }
  
  if(stik_mean >= t_ki[1] & stik_mean <= t_ki[2]){
    test_t <- append(test_t, 1)
  }else{
    test_t <- append(test_t, 0)
  }
  
  return(c(test_perc, test_basic, test_t))
})

daek_percentil <- sum(daekningsgrad[1,])
daek_basic <- sum(daekningsgrad[2,])
daek_t <- sum(daekningsgrad[3,])

daek_percentil
daek_basic
daek_t
```














