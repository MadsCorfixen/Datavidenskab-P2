
```{r}
stikfunc <- function(pop, n){
  return(sample(pop, n))
}
```

```{r}
percentil_konf <- function(pop, n, B, alpha){
  data <- stikfunc(pop, n)
  
  bootstrap_fordeling <- replicate(B, {
  x <- mean(sample(data, size = n, replace = TRUE))
  })
  
  SortedData <- sort(bootstrap_fordeling)
  
  KI_nedre <- quantile(SortedData, probs = alpha/2)
  KI_oevre <- quantile(SortedData, probs = 1-alpha/2)
  percentil_KI <- c(KI_nedre, KI_oevre)
  return(percentil_KI)
}
```




```{r}
daekningsgrad <- function(pop, n, r, KI){
  sandhed <- 0
  replicate(r, {
    data <- sample(pop, n)
    middel <- mean(data)
    if(KI[1] <= middel & KI[2] >= middel){
      sandhed <- sandhed + 1
      return(sandhed)
    } 
  })
  return(sandhed)
}

daekningsgrad(rbeta(10000, 8, 2), 100, 100, percentil_konf(rbeta(10000, 8, 2), 100, 10000, 0.05))
```


```{r}
pop <- rbeta(10000, 8, 2)

vektor <- c()
for(n in seq(5, 100, 5)){
  KI <- percentil_konf(pop, n, 10000, 0.05)
  magnus <- daekningsgrad(pop, 100, 100, KI)
  vektor <- append(vektor, magnus[1])
}
vektor
```







