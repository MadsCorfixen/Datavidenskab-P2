## Hypotesetest
(FIXME: KILDER: https://asta.math.aau.dk/course/asta/2020-1/std/lecture/2-1?file=B/lecture-B-1.html#(1)
[@ASTA-HYPO]
http://people.math.aau.dk/~sorenh/misc/2019-mariagerfjord/hypotese-test-19.pdf)


En hypotesetest er givet ved en formodning, derved hypotese, om en given population forholder sig på en bestemt måde, hvilket der undersøges. Heraf opstilles to hypoteser. En nulhypotese, $H_0$, og en alternativ hypotese $H_1$. Nulhypotesen er den antagelse der er taget, hvor den alternative hypotese påviser at det ikke er tilfældet, og derved at noget andet er gældende. 

På baggrund af en normalfordeling er det muligt at lave en hypotesetest ud fra følgende med en t-test. [@ASTA-HYPO] 

* Udregner estimater for parametrene af populationen, middelværdien, $\hat \mu = \bar y$ og standardafvigelsen, $\hat \sigma = s$ ud fra $n$ observationer.

* En nulhypotese: $H_0 : \mu = \mu_{forventet}$ og en alternativ hypotese: $H_a : \mu \neq \mu_{forventet}$.

* Udregne den observerede teststørrelse, $t_{obs} = \frac{\bar y - \mu_o}{\frac{s}{\sqrt{n}}}$.

* Frihedsgrader, $df = n-1$.

* *P*-værdien, som kan slåes op eller findes i r ved ```2 * (1 - pdist("t", q = t_obs, df = n-1))```.

* Derudover sættes et signifikansniveau, $\alpha$, som vuderer hvorvidt $H_0$ forkastes eller ej.

For at undersøge plausibiliteten af $H_0$, benyttes *p*-værdien, som er sandsynligheden for at observere en lignende, eller mere ekstrem værdi af $t_{obs}$ under antagelsen at $H_0$ er sand. Jo mindre *p*-værdi, des mere tilbøjelig er man til at forkaste $H_0$ og antage $H_a$. *P*-værdien er givet ved,(FIXME: Ikke helt sikker) $p(\hat H_0 \geq t_{obs})$. Er $p < \alpha$ forkastes $H_0$, hvor den ikke kan forkastes, hvis $p > \alpha$.

```{r, include = FALSE}
xdata <- c(0.514, 0.510, 0.512, 0.524, 0.494, 0.502, 0.522, 0.489)
x_mean <- mean(xdata)
forventet_mean <- 0.5
```

### Eksempler
Har man et normalfordelt datasæt er det muligt at undersøge om observationerne modstrider hypotesen eller ej. Eksempelvis har man et datasæt med en middelværdi på ```r x_mean``` og en forventet middelværdi på ```r forventet_mean```, så kan man undersøge om forskellen er signifikant.

```{r}
set.seed(1)

forventet_mean <- 0.5 # Forventet middelværdi

xdata <- c(0.514, 0.510, 0.512, 0.524, 0.494, 0.502, 0.522, 0.489)

n = length(xdata)

x_mean <- mean(xdata) # Middelværdi
x_sd <- sd(xdata) # Standardafvigelsen
x_ese <- x_sd/sqrt(n) # Estimeret standardfejl

x_t_obs <- (x_mean-forventet_mean)/x_ese # Observeret teststørrelse

x_p = 2 * (1 - pdist("t", q = x_t_obs, df = n-1, plot = FALSE))
```

```{r include = FALSE}
forventet_meanx = 0.49
x_t_obsx <- (x_mean-forventet_meanx)/x_ese # Observeret teststørrelse
x_px = 2 * (1 - pdist("t", q = x_t_obsx, df = n-1, plot = FALSE))
```

Eftersom *p*-værdien er ```r x_p``` $> \alpha=0.05$, forkastes $H_0$ ikke. Havde det derimod været en forventet værdi på ```r forventet_meanx```, ville *p*-værdien blive ```r x_px``` $< \alpha=0.05$, hvilket vil medføre, at $H_0$ forkastes.

### Fejltyper

Der er risiko for to primære fejl når der foretages en hypotesetest. Den første, type-1 fejl, er hvor $H_0$ forkastes, men i virkeligheden er sand, og den anden, type-2 fejl, er hvor $H_0$ accepteres, men i realiteten er falsk.

En af de primære årsager til disse typer fejl er, hvor signifikansniveauet bliver sat, da dette i nogle tilfælde har stor betydning for, hvorvidt en hypotese bliver forkastet eller ej.

Sandsynligheden for type-1 fejl er lig med det valgte signifikansniveau - i de fleste tilfælde 5%. Sandsynligheden for type-2 fejl er derimod ikke let at præcisere. Dog er der stor sandsynlighed for type-2 fejl, hvis den virkelige sandhed er tæt på hypotesen og lille, hvis den er langt fra. Ligeledes har stikprøvens størrelse indflydelse, eftersom meget data mindsker risikoen for type-2 fejl, hvor der er større risiko ved mindre data. [@Fejltyper]

Det er derved ikke altid den rigtige konklusion, man kommer frem til, eftersom man ikke kender de virkelige værdier. 














